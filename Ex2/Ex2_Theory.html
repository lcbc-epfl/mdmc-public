
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.1. Statistical Thermodynamics and the Boltzmann Distribution &#8212; Molecular Dynamics and Monte Carlo</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"TeX": {"Macros": {"ket": ["\\lvert #1 \\rangle", 1], "bra": ["\\langle #1 \\lvert", 1], "Ket": ["\\lvert #1 \\rangle", 1], "Bra": ["\\langle #1 \\lvert", 1], "braket": ["\\langle #1 \\lvert #2 \\rangle", 2], "hop": "\\hat{\\mathcal{H}}", "unit": "\\mathbbm{1}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Ex2/Ex2_Theory';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.2. Boltzmann Distribution Harmonic Oscillator" href="Boltzmann.html" />
    <link rel="prev" title="2. Statistical Thermodynamics and the Boltzmann Distribution" href="MDMC_ex2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Molecular Dynamics and Monte Carlo</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Molecular Dynamics and Monte Carlo
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex1/MDMC_Ex1.html">1. Basic Concepts of Molecular Dynamics and Monte Carlo Simulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex1/Ex1_Theory.html">1.1. From Quantum to Classical Mechanics: The Example of Forces</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Ex1/MonteCarloPI.html">1.3. Monte Carlo <span class="math notranslate nohighlight">\(\pi\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex1/prng.html">1.4. Appendix: Random and Pseudo-random Numbers</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="MDMC_ex2.html">2. Statistical Thermodynamics and the Boltzmann Distribution</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2.1. Statistical Thermodynamics and the Boltzmann Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="Boltzmann.html">2.2. Boltzmann Distribution Harmonic Oscillator</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex3/MDMC_ex3.html">3. Monte Carlo Simulations and the Photon Gas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/Ex3_Theory.html">3.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/PhotonGas.html">3.2. The Photon Gas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/LJ_NVT.html">3.3. The Lennard-Jones Potential</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex4/MDMC_ex4.html">4. Introduction to Molecular Dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex4/Theory.html">4.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex4/Exercise.html">4.2. MD simulation from scratch</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex5/MDMC_ex5.html">5. Classical Molecular Dynamics (MD) Simulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/theory.html">5.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/Exercise.html">5.2. ToyMD</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex6/MDMC_ex6.html">6. Properties from Molecular Dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/theory.html">6.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/proteinmodelling.html">6.2. Protein Modelling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/TRP_Cage.html">6.3. Practical: TRP Cage using OpenMM</a></li>

</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://noto.epfl.ch/hub/user-redirect/git-pull?repo=https%3A//github.com/lcbc-epfl/mdmc-public&urlpath=lab/tree/mdmc-public/mdmc/Ex2/Ex2_Theory.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/lcbc-epfl/mdmc-public/blob/main/mdmc/Ex2/Ex2_Theory.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lcbc-epfl/mdmc-public" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lcbc-epfl/mdmc-public/issues/new?title=Issue%20on%20page%20%2FEx2/Ex2_Theory.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Ex2/Ex2_Theory.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Statistical Thermodynamics and the Boltzmann Distribution</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">2.1.1. Background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-thermodynamics">2.1.1.1. Statistical Thermodynamics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-canonical-ensemble-and-the-canonical-partition-function">2.1.1.2. The Canonical Ensemble and the Canonical Partition Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-quantum-mechanical-partition-function-and-the-density-operator">2.1.1.3. The Quantum Mechanical Partition Function and the Density Operator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-isothermal-isobaric-ensemble">2.1.1.4. The Isothermal-Isobaric ensemble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamic-quantities-as-derivatives-of-the-canonical-partition-function">2.1.1.5. Thermodynamic Quantities as Derivatives of the Canonical Partition Function</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="statistical-thermodynamics-and-the-boltzmann-distribution">
<h1><span class="section-number">2.1. </span>Statistical Thermodynamics and the Boltzmann Distribution<a class="headerlink" href="#statistical-thermodynamics-and-the-boltzmann-distribution" title="Link to this heading">#</a></h1>
<p>This set of exercises brings together the theory of statistical mechanics with a practical
example, the harmonic oscillator. After a brief (re)introduction to statistical mechanics,
you will write a code that computes the probability distribution of the energy of a system
using Boltzmann statistics.</p>
<section id="background">
<h2><span class="section-number">2.1.1. </span>Background<a class="headerlink" href="#background" title="Link to this heading">#</a></h2>
<section id="statistical-thermodynamics">
<h3><span class="section-number">2.1.1.1. </span>Statistical Thermodynamics<a class="headerlink" href="#statistical-thermodynamics" title="Link to this heading">#</a></h3>
<p>The average behaviour of a macroscopic system, the state of which is uncertain, can
be studied using probability theory (statistical mechanics). However, such a probabilistic description cannot make thermodynamic properties accessible, unless a link between
thermodynamic (free energy, pressure, entropy) and mechanical (position, momenta)
properties can be introduced on the microscopic scale. Statistical thermodynamics (or
equilibrium statistical mechanics) is concerned with the description of classical thermodynamics from a microscopic picture in terms of the particles that constitute the thermodynamical system. Statistical thermodynamics thus provide a link between the system’s
microscopic properties and its macroscopic behaviour. The following constitutes a brief
summary of the most important concepts in statistical mechanics (phase space, entropy
as a phase space volume, partition functions). The discussion starts from the classical
description of the microcanonical ensemble and is then extended onto the canonical and
grandcanonical ensemble, with a link between quantum mechanics and the canonical
ensemble being provided at the end of this chapter.</p>
<p>Any system that consists of <span class="math notranslate nohighlight">\(N\)</span> particles can be characterised in terms of a 6N-dimensional set of variables: 3N coordinates <span class="math notranslate nohighlight">\(\mathbf{q} = \left\{\mathbf{q}_1,\dots,\mathbf{q}_N\right\}\)</span>
and 3N momenta <span class="math notranslate nohighlight">\(\mathbf{p} = \left\{\mathbf{p}_1,\dots,\mathbf{p}_N\right\}\)</span>. At every instant,
the system is described by the values of <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> within a 6N-dimensional space, the <strong>phase space</strong> <span class="math notranslate nohighlight">\(\Gamma = \left(\mathbf{p},\mathbf{q}\right)\)</span>.
The point in phase space that characterises its current
state identifies a point referred to as the <strong>representative point</strong>. The system <strong>i.e.</strong> its representative point will evolve within phase space according to its Hamiltonian:</p>
<div class="math notranslate nohighlight" id="equation-hamiltonian-rp">
<span class="eqno">(2.1)<a class="headerlink" href="#equation-hamiltonian-rp" title="Link to this equation">#</a></span>\[
\begin{align}
H = \sum_{i=1}^N \left[\frac{\mathbf{p}_i^2}{2m_i} + U\left(\mathbf{q}_1,\dots,\mathbf{q}_N\right) \right].
\end{align}
\]</div>
<p>Note that in the classical limit, the Hamiltonian is not an operator, but a sum over kinetic and potential energy terms.
The evolution of the system in phase space is governed by Hamilton’s equations of motion:</p>
<div class="math notranslate nohighlight" id="equation-evo-in-p">
<span class="eqno">(2.2)<a class="headerlink" href="#equation-evo-in-p" title="Link to this equation">#</a></span>\[\begin{split}  
\begin{align}
\frac{\mathrm{d}\mathbf{p}_i}{\mathrm{d}t} &amp;= -\frac{\partial{H}}{\partial{\mathbf{q}_i}}\\
\frac{\mathrm{d}\mathbf{q}_i}{\mathrm{d}t} &amp;= \frac{\partial{H}}{\partial{\mathbf{p}_i}}.
\end{align}
\end{split}\]</div>
<p>As is evident from  <a class="reference internal" href="#equation-evo-in-p">(2.2)</a>, this formulation is an equivalent of Newtonian mechanics.
Given a representative point, the evolution of the system in phase space is thus fully determined by Hamilton’s equations of motion.
For an isolated system of constant particle number <span class="math notranslate nohighlight">\(N\)</span>, constant volume <span class="math notranslate nohighlight">\(V\)</span> and constant energy <span class="math notranslate nohighlight">\(E\)</span>, the trajectory of the system will lie on a hypersurface defined by:</p>
<div class="math notranslate nohighlight" id="equation-nve-hypersurface">
<span class="eqno">(2.3)<a class="headerlink" href="#equation-nve-hypersurface" title="Link to this equation">#</a></span>\[  
\begin{align}
H = E = \text{const.}
\end{align}
\]</div>
<p>Such a constant-<span class="math notranslate nohighlight">\(NVE\)</span> system of particles is described by a statistical ensemble referred to as the <strong>microcanonical ensemble</strong>.
In the microcanonical ensemble, a system will move on the 6N dimensional hypersurface spanned by coordinates and momenta that lead to the same total energy <span class="math notranslate nohighlight">\(E\)</span>.</p>
<p>Each of the possible representative points <span class="math notranslate nohighlight">\(\mathbf{p},\mathbf{q}\)</span> that give rise to the same energy <span class="math notranslate nohighlight">\(E\)</span> correspond to one <strong>microstate</strong> of the system.
In general, for a thermodynamic state that is characterised by a set of extensive variables <span class="math notranslate nohighlight">\(\left\{X_0,\dots,X_r\right\}\)</span>,
the <span class="math notranslate nohighlight">\(\left\{X_i\right\}\)</span> will be a function over microscopic states <span class="math notranslate nohighlight">\(\left\{\mathbf{p},\mathbf{q}\right\}\)</span>, such that
<span class="math notranslate nohighlight">\(X(\mathbf{r},\mathbf{q}) = X(\Gamma)\)</span>. The region of phase space that is accessible to the system <span class="math notranslate nohighlight">\(X(\mathbf{p},\mathbf{q})\)</span> is thus determined and limited by the values of <span class="math notranslate nohighlight">\(X\)</span>.
Such an `accessible region’ in phase space is (within the error of the variables <span class="math notranslate nohighlight">\(X\)</span>) denoted by <span class="math notranslate nohighlight">\(W(E)\)</span>,
with the corresponding volume element being <span class="math notranslate nohighlight">\(|W(E)|\)</span>.
According to the fundamental postulate of statistical mechanics, since every microstate has the same energy,
the system is equally likely to be found in any of its microstates. In terms of the
volume element in phase space, the probability to find the system in one of its microstates is:</p>
<div class="math notranslate nohighlight" id="equation-p-microstate">
<span class="eqno">(2.4)<a class="headerlink" href="#equation-p-microstate" title="Link to this equation">#</a></span>\[  
\begin{align}
P(E) = \frac{1}{|W(E)|}.
\end{align}
\]</div>
<p>Based on <span class="math notranslate nohighlight">\(W(E)\)</span>, <strong>any</strong> thermodynamical property and observable
is now accessible as a <strong>phase-space</strong> or <strong>ensemble average</strong>. For a microcanonical ensemble, the expectation value of an observable <span class="math notranslate nohighlight">\(O\)</span> is simply:</p>
<div class="math notranslate nohighlight" id="equation-expectation-value-o">
<span class="eqno">(2.5)<a class="headerlink" href="#equation-expectation-value-o" title="Link to this equation">#</a></span>\[ 
 \begin{align}
\left&lt; O \right &gt; = \int_{\Gamma \in W(E)} \frac{1}{|W(E)|} O(\Gamma) \mathrm{d}\Gamma ,
\end{align}
\]</div>
<p>where the integration is over the 6N variables within the phase space volume elements <span class="math notranslate nohighlight">\(d\Gamma\)</span> that are contained in <span class="math notranslate nohighlight">\(W(E)\)</span>.
The above equation is nothing but the <strong>probability density</strong> of the system to be in a macroscopic state with the property <span class="math notranslate nohighlight">\(O\)</span>
(recall the general form of a probability density).</p>
<p>Macroscopic observables are therefore linked to microscopic quantities using simple tools of <strong>statistics</strong>.</p>
<p>The Hamiltonian quantifies the kinetic and potential energy of the system, but the concept of entropy has
been absent from the discussion so far. According to Boltzmann’s fundamental postulate of statistical thermodynamics, the entropy of a system is linked to the accessible volume <span class="math notranslate nohighlight">\(W(E)\)</span> in phase space,
<strong>i.e.</strong> the entropy of a system in state <span class="math notranslate nohighlight">\(X(\Gamma)\)</span> is related to the volume accessible to <span class="math notranslate nohighlight">\(X\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-entropy">
<span class="eqno">(2.6)<a class="headerlink" href="#equation-entropy" title="Link to this equation">#</a></span>\[  
\begin{align}
S = k_B \ln |W(E)|,
\end{align}
\]</div>
<p>where <span class="math notranslate nohighlight">\(S\)</span> is the entropy as introduced for macroscopic systems, and <span class="math notranslate nohighlight">\(k_B\)</span> is Boltzmann’s constant.</p>
<p>Thus, a link between thermodynamic quantities and the system’s microscopic states is established, allowing for the prediction of <strong>any</strong> thermodynamic observable.</p>
<p>However, the 6N dimensionality of the problem restricts the analytic expressions of the above equations to small model systems;
thermodynamic properties <strong>e.g.</strong> of a protein are in practice
impossible to predict (although the exact Hamiltonian of the system is of course known). The great value of the techniques taught in this course lies in them providing alternative approaches to calculate thermodynamical properties as ensemble averages, but without explicitly relying on <a class="reference internal" href="#equation-expectation-value-o">(2.5)</a>.</p>
</section>
<section id="the-canonical-ensemble-and-the-canonical-partition-function">
<h3><span class="section-number">2.1.1.2. </span>The Canonical Ensemble and the Canonical Partition Function<a class="headerlink" href="#the-canonical-ensemble-and-the-canonical-partition-function" title="Link to this heading">#</a></h3>
<p>The statistical concepts considered so far can be extended onto systems of constant particle number <span class="math notranslate nohighlight">\(N\)</span>, constant volume <span class="math notranslate nohighlight">\(V\)</span> and constant temperature <span class="math notranslate nohighlight">\(T\)</span>, rather than constant energy.
The derivation of the properties of an <span class="math notranslate nohighlight">\(NVT\)</span>-ensemble starts from the microcanonical ensemble. The <span class="math notranslate nohighlight">\(NVT\)</span> system is considered to be in contact with a much larger <strong>thermal bath</strong>,
the purpose of which it is to exchange energy with the <span class="math notranslate nohighlight">\(NVT\)</span>-subsystem such that the subsystem’s temperature remains constant, without the energy of the overall system (<strong>i.e.</strong> including the bath) changing due to its enormous size.
An <span class="math notranslate nohighlight">\(NVT\)</span> system of particles is represented by the <strong>canonical ensemble</strong>. According to Boltzmann and Gibbs, the expectation value of an observable is again an ensemble average,</p>
<div class="math notranslate nohighlight" id="equation-expectation-value">
<span class="eqno">(2.7)<a class="headerlink" href="#equation-expectation-value" title="Link to this equation">#</a></span>\[  
\begin{align}
\left&lt; O \right &gt; = \int_\Gamma \frac{1}{Z} O(\Gamma) e^{- \beta E(\Gamma)} \mathrm{d}\Gamma
\end{align}
\]</div>
<p>but now weighted by some exponential factor - the <strong>Boltzmann factor</strong> - that takes into account the energy of every possible microstate.
<strong>En passant</strong>, we have introduced the <strong>canonical partition function</strong> <span class="math notranslate nohighlight">\(Z(N,V,T)\)</span> as the counterpart of the microcanonical <span class="math notranslate nohighlight">\(W\)</span>, as well as the inverse of the temperature,
the <strong>thermodynamic beta</strong>, <span class="math notranslate nohighlight">\(\beta = \frac{1}{k_B T}\)</span>. Again, the expression is a simple probability density function.
It can be shown that for the above to be a valid normalised probability distribution, <span class="math notranslate nohighlight">\(Z(N,V,T)\)</span> must be of the form:</p>
<div class="math notranslate nohighlight" id="equation-canonical-partitionfunction">
<span class="eqno">(2.8)<a class="headerlink" href="#equation-canonical-partitionfunction" title="Link to this equation">#</a></span>\[  
\begin{align}
Z(N,V,T) = \frac{1}{N!\ h^{mN}}\int_\Gamma e^{-\beta E(\Gamma)} \mathrm{d}\Gamma,
\end{align}
\]</div>
<p><strong>i.e.</strong> the partition function is nothing but the integral over all possible microstates that the system can assume. Since classical states are indistinguishable
and uncountable (they form a continuum), the partition function has to be normalised to avoid overcounting (<span class="math notranslate nohighlight">\(N!\)</span>) and to account for <span class="math notranslate nohighlight">\(Z\)</span> being dimensionless (<span class="math notranslate nohighlight">\(h^{mN}\)</span>, where
<span class="math notranslate nohighlight">\(m\)</span> is the dimensionalty of the integral over position and momenta).
The microstates do not share an equal probability as in the
microcanonical ensemble, and the integral is over <strong>all</strong>  phase space rather than over a restricted region.
According to the above definitions, the probability of observing a microstate <span class="math notranslate nohighlight">\(s\)</span> is given by its energetic weight:</p>
<div class="math notranslate nohighlight" id="equation-probability-microstate-canonical">
<span class="eqno">(2.9)<a class="headerlink" href="#equation-probability-microstate-canonical" title="Link to this equation">#</a></span>\[  
\begin{align}
P(E_s) = \frac{1}{Z}g_s e^{-\beta E_s},
\end{align}
\]</div>
<p>where <span class="math notranslate nohighlight">\(g_s\)</span> takes into account possible degeneracies.
In general, the classical case does not hold and the microstates do not form a continuum, but are discrete and as such countable.
Therefore, the integrals in <a class="reference internal" href="#equation-canonical-partitionfunction">(2.8)</a> and <a class="reference internal" href="#equation-probability-microstate-canonical">(2.9)</a> may be recast as sums:</p>
<div class="math notranslate nohighlight" id="equation-recast-expectation-value">
<span class="eqno">(2.10)<a class="headerlink" href="#equation-recast-expectation-value" title="Link to this equation">#</a></span>\[  
\begin{align}
\left&lt; O \right &gt; = \sum_s \frac{1}{Z(T)}g_s O_s e^{- \beta E_s},
\end{align}
\]</div>
<p>where the canonical partition function is now a sum over states:</p>
<div class="math notranslate nohighlight" id="equation-canonical-sumofstates">
<span class="eqno">(2.11)<a class="headerlink" href="#equation-canonical-sumofstates" title="Link to this equation">#</a></span>\[  
\begin{align}
Z(N,V,T) = \sum_i g_i e^{-\beta E_i}.
\end{align}
\]</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 1</p>
<p>A quantum harmonic oscillator has energy levels: <span class="math notranslate nohighlight">\( E_n = \left(n + \frac{1}{2}\right)\hbar \omega\)</span>.<br>
Write down the corresponding canonical partition function
<span class="math notranslate nohighlight">\(Z(N,V,T)\)</span>.  Note that in this case, the partition function forms an
infinite geometric series, and can be rewritten in terms of the
<span class="math notranslate nohighlight">\(n \rightarrow \infty\)</span> limit of the series.<p>
From the result you obtain, derive the expectation value of the energy.
Use the limit of the geometric series for <span class="math notranslate nohighlight">\(Z\)</span>, rather than the sum-based form.</p>
</div>
</section>
<section id="the-quantum-mechanical-partition-function-and-the-density-operator">
<h3><span class="section-number">2.1.1.3. </span>The Quantum Mechanical Partition Function and the Density Operator<a class="headerlink" href="#the-quantum-mechanical-partition-function-and-the-density-operator" title="Link to this heading">#</a></h3>
<p>This section briefly relates the concepts treated so far with the density matrix formalism introduced in the course `Introduction to Electronic Structure Methods’.
The density operator (called the density matrix in position basis) is at the base of the quantum mechanical formulation of statistical mechanics,
since it casts the problem into a basis-independent form. Recall that a density operator in <strong>state basis</strong></p>
<div class="math notranslate nohighlight" id="equation-density-operator">
<span class="eqno">(2.12)<a class="headerlink" href="#equation-density-operator" title="Link to this equation">#</a></span>\[\begin{split}  
\begin{align}
\hat{\rho} &amp;= \sum_i p_i \hat{\gamma}_i \\
&amp;= \sum_i p_i \left| {\Psi_i} \right&gt; \left&lt; {\Psi_i} \right|
\end{align}
\end{split}\]</div>
<p>can be used to describe both mixed (<span class="math notranslate nohighlight">\(p_0 &lt; 1\)</span>) and pure states (<span class="math notranslate nohighlight">\(p_0 = 1\)</span>, where the density operator becomes a projector),
and that its diagonal elements play the role of a probability if the states are orthogonal. Note that <span class="math notranslate nohighlight">\(Tr\left( \hat{\rho}\right) = 1\)</span>
applies for non-orthogonal states as well. The <span class="math notranslate nohighlight">\(\gamma_i\)</span> are pure-state density matrices that admit some eigenbasis <span class="math notranslate nohighlight">\(\left\{\left|{i}\right&gt;\right\}\)</span>.
The great benefit of the density operator formalism lies in its intrinsic ability to describe statistical mixtures of
states if they are entangled. In this case, the Hilbert spaces of the respective Hamiltonians form a composite system of Hilbert spaces <span class="math notranslate nohighlight">\(\mathbb{H}_1 \otimes \mathbb{H}_2\)</span>, and either
<span class="math notranslate nohighlight">\(\mathbb{H}_1\)</span> or <span class="math notranslate nohighlight">\(\mathbb{H}_2\)</span> will be inaccessible to any observation. Density matrices allow for the determination of the properties of either subsystem by means
of the <strong>partial trace</strong> over the other respective Hilbert space, incorporating statistical uncertainties.</p>
<p>The <strong>canonical</strong> density matrix is defined as:</p>
<div class="math notranslate nohighlight" id="equation-canonical-density-matrix">
<span class="eqno">(2.13)<a class="headerlink" href="#equation-canonical-density-matrix" title="Link to this equation">#</a></span>\[  
\begin{align}
\hat{\rho} &amp;= \frac{1}{Z}e^{-\beta \mathrm{\hat{H}}},
\end{align}
\]</div>
<p>and the <strong>canonical partition function</strong> is:</p>
<div class="math notranslate nohighlight" id="equation-canonical-partition-function">
<span class="eqno">(2.14)<a class="headerlink" href="#equation-canonical-partition-function" title="Link to this equation">#</a></span>\[ 
 \begin{align}
Z(N,V,T) &amp;= \text{Tr} \left(e^{-\beta \mathrm{\hat{H}}}\right).
\end{align}
\]</div>
<p>In the eigenbasis <span class="math notranslate nohighlight">\(\left\{\ket{\Psi_s}\right\}\)</span> of <span class="math notranslate nohighlight">\(\mathrm{\hat{H}}\)</span> (a specific rather than a general case), one may write</p>
<div class="math notranslate nohighlight" id="equation-canonical-density-matrix-recast">
<span class="eqno">(2.15)<a class="headerlink" href="#equation-canonical-density-matrix-recast" title="Link to this equation">#</a></span>\[\begin{split} 
\begin{align}
\hat{\rho} &amp;= \frac{1}{Z}\sum_s e^{-\beta \mathrm{\hat{H}}}\ket{\Psi_s}\bra{\Psi_s} \\
&amp;= \frac{1}{Z} \sum_s \ket{\Psi_s}e^{-\beta E_s}\bra{\Psi_s}.
\end{align}
\end{split}\]</div>
<p>Note that the trace is only defined in some orthonormal basis <span class="math notranslate nohighlight">\(\left\{\ket{\Psi}\right\}\)</span>, and that the basis may be chosen to diagonalise <span class="math notranslate nohighlight">\(\hat{\rho}\)</span> (but not forcibly <span class="math notranslate nohighlight">\(\hat{\mathrm{H}}\)</span>).
The above definitons are still unambiguous, since the trace is invariant under a change of basis.
In the eigenbasis of the Hamiltonian (<strong>i.e.</strong> in the absence of coherence), the partition function becomes:</p>
<div class="math notranslate nohighlight" id="equation-partition-function-eigenbasis">
<span class="eqno">(2.16)<a class="headerlink" href="#equation-partition-function-eigenbasis" title="Link to this equation">#</a></span>\[ 
 \begin{align}
Z(N,V,T) &amp;= \sum_i e^{-\beta E_i},
\end{align}
\]</div>
<p>which recovers the form of <a class="reference internal" href="#equation-canonical-sumofstates">(2.11)</a>, and <span class="math notranslate nohighlight">\(p_s = \frac{1}{Z} e^{-\beta E_s}\)</span>.</p>
<p>Hence, given a system’s density matrix, all of its thermodynamic properties can be derived:</p>
<div class="math notranslate nohighlight" id="equation-thermodynamic-properties">
<span class="eqno">(2.17)<a class="headerlink" href="#equation-thermodynamic-properties" title="Link to this equation">#</a></span>\[  
\begin{align}
\hat{\left&lt;\mathrm{O}\right&gt;} &amp;= \text{Tr}\left(\hat{\mathrm{O}}\hat{\rho}\right),
\end{align}
\]</div>
<p>and, if <span class="math notranslate nohighlight">\(\left[\hat{\mathrm{H}},\hat{\mathrm{O}}\right] = 0\)</span>, then:</p>
<div class="math notranslate nohighlight" id="equation-classical-probability">
<span class="eqno">(2.18)<a class="headerlink" href="#equation-classical-probability" title="Link to this equation">#</a></span>\[  
\begin{align}
\hat{\left&lt;\mathrm{O}\right&gt;} &amp;= \frac{1}{Z} \sum_s \mathrm{O}_s e^{-\beta E_s},
\end{align}
\]</div>
<p>which recovers the expression for the classical probability distribution function presented in the preceeding section.</p>
<div class="exercise admonition">
<p class="admonition-title">Exercise 2- Bonus</p>
<p>Show that, based on <a class="reference internal" href="#equation-thermodynamic-properties">(2.17)</a>, the canonical partition function <a class="reference internal" href="#equation-classical-probability">(2.18)</a> is obtained from <a class="reference internal" href="#equation-canonical-density-matrix">(2.13)</a> if the Hamiltonian admits an orthonormal eigenbasis <span class="math notranslate nohighlight">\(\left\{\ket{\Psi_i}\right\}\)</span> and the commutator <span class="math notranslate nohighlight">\(\left[\hat{\mathrm{H}},\hat{\mathrm{O}}\right]\)</span> vanishes. (There is no need to use the commutator itself, applying conditions that follow from vanishing commutators is sufficient.)</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 3 - Bonus</p>
<p>Show from <a class="reference internal" href="#equation-density-operator">(2.12)</a> and <a class="reference internal" href="#equation-canonical-density-matrix">(2.13)</a> that the <span class="math notranslate nohighlight">\(p_i\)</span> are indeed equal to <span class="math notranslate nohighlight">\(\frac{1}{Z}e^{-\beta E_i}\)</span> for pure states, given that there exists a common eigenbasis <span class="math notranslate nohighlight">\(\left\{\ket{\Psi_i}\right\}\)</span> to the total Hamiltonian and explain the origin of this restriction.
Explain why the density operator and the expression for the expectation value of an observable assume a general form (<a class="reference internal" href="#equation-canonical-density-matrix">(2.13)</a> and <a class="reference internal" href="#equation-thermodynamic-properties">(2.17)</a>), rather than being defined directly in terms of <a class="reference internal" href="#equation-canonical-density-matrix-recast">(2.15)</a> and <a class="reference internal" href="#equation-classical-probability">(2.18)</a>.
(You may link your answer to the assumptions made in the previous question).</p>
</div>
</section>
<section id="the-isothermal-isobaric-ensemble">
<h3><span class="section-number">2.1.1.4. </span>The Isothermal-Isobaric ensemble<a class="headerlink" href="#the-isothermal-isobaric-ensemble" title="Link to this heading">#</a></h3>
<p>The isothermal-isobaric or <span class="math notranslate nohighlight">\(NpT\)</span>-ensemble is of great practical relevance in chemistry. The isothermal-isobaric partition function is a weighted sum over canonical partition functions,
where the definition of the weighting factor is ambiguous:</p>
<div class="math notranslate nohighlight" id="equation-isothermal-isobaric-partitionfunction">
<span class="eqno">(2.19)<a class="headerlink" href="#equation-isothermal-isobaric-partitionfunction" title="Link to this equation">#</a></span>\[  
\begin{align}
\Delta(N,p,T) = \int Z(N,V,T)e^{-\beta pV}\frac{N}{V}\mathrm{d}V,
\end{align}
\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-isothermal-isobaric-partitionfunction-alt">
<span class="eqno">(2.20)<a class="headerlink" href="#equation-isothermal-isobaric-partitionfunction-alt" title="Link to this equation">#</a></span>\[  
\begin{align}
\Delta(N,p,T) = \int Z(N,V,T)e^{-\beta pV}\beta p~\mathrm{d}V.
\end{align}
\]</div>
<p>Both definitions become equal if <span class="math notranslate nohighlight">\(N \rightarrow \infty\)</span>, <span class="math notranslate nohighlight">\(V \rightarrow \infty\)</span> and <span class="math notranslate nohighlight">\(\frac{N}{V} = \text{const}\)</span>, the <strong>thermodynamic limit</strong>.</p>
</section>
<section id="thermodynamic-quantities-as-derivatives-of-the-canonical-partition-function">
<h3><span class="section-number">2.1.1.5. </span>Thermodynamic Quantities as Derivatives of the Canonical Partition Function<a class="headerlink" href="#thermodynamic-quantities-as-derivatives-of-the-canonical-partition-function" title="Link to this heading">#</a></h3>
<p>Thermodynamic properties can be directly derived from the partition function. In the canonical ensemble, the energy of the system is given by</p>
<div class="math notranslate nohighlight" id="equation-energy-canonical">
<span class="eqno">(2.21)<a class="headerlink" href="#equation-energy-canonical" title="Link to this equation">#</a></span>\[  
\begin{align}
E = -\frac{\partial}{\partial \beta} \ln Z,
\end{align}
\]</div>
<p>whereas the Helmholtz free energy (<span class="math notranslate nohighlight">\(A \equiv U - TS\)</span>) is obtained from</p>
<div class="math notranslate nohighlight" id="equation-helmholtz-canonical">
<span class="eqno">(2.22)<a class="headerlink" href="#equation-helmholtz-canonical" title="Link to this equation">#</a></span>\[ 
 \begin{align}
A = -kT \ln Z,
\end{align}
\]</div>
<p>and, finally, the entropy can be derived according to:</p>
<div class="math notranslate nohighlight" id="equation-entropy-canonical">
<span class="eqno">(2.23)<a class="headerlink" href="#equation-entropy-canonical" title="Link to this equation">#</a></span>\[  
\begin{align}
S = k_B \frac{\partial}{\partial T}\left( T \ln Z\right).
\end{align}
\]</div>
<p>The probability of finding a particle in a microstate <span class="math notranslate nohighlight">\(s\)</span> is given by the Boltzmann distribution:</p>
<div class="math notranslate nohighlight" id="equation-boltzmann">
<span class="eqno">(2.24)<a class="headerlink" href="#equation-boltzmann" title="Link to this equation">#</a></span>\[  
\begin{align}
P(E_s) = \frac{N_s}{N} = \frac{g_s e^{-\beta E_s}}{\sum_i g_i e^{-\beta E_i}} = \frac{1}{Z}g_s e^{-\beta E_s},
\end{align}
\]</div>
<p>where <span class="math notranslate nohighlight">\(N_s\)</span> are the number of particles in the microstate <span class="math notranslate nohighlight">\(s\)</span>, <span class="math notranslate nohighlight">\(N\)</span> is the total number of particles and <span class="math notranslate nohighlight">\(E_s\)</span> is the energy of microstate <span class="math notranslate nohighlight">\(s\)</span>.</p>
<div class="exercise admonition">
<p class="admonition-title">Exercise 4</p>
<p>Derive the Boltzmann distribution, <a class="reference internal" href="#equation-boltzmann">(2.24)</a>, from <a class="reference internal" href="#equation-recast-expectation-value">(2.10)</a>, using the   expectation value of the particle number in state <span class="math notranslate nohighlight">\(s\)</span>, <span class="math notranslate nohighlight">\(N_s\)</span>, as observable.
<em>Hint</em>: It may be useful to remember that the ensamble average in <a class="reference internal" href="#equation-recast-expectation-value">(2.10)</a> can be always expressed also as the probability of being in that state, times their value: <span class="math notranslate nohighlight">\(\left&lt; O_s \right&gt; = p_s O_s\)</span>.</p>
</div>
<p>In this exercise you will apply the Boltzmann distribution <a class="reference internal" href="#equation-boltzmann">(2.24)</a> to determine the occupancy of states for a fictitious harmonic oscillator.  <a class="reference internal" href="#harmonic-oscillator"><span class="std std-numref">Fig. 2.1</span></a> presents our system.</p>
<p>Here, individual states are separated by the energy <span class="math notranslate nohighlight">\(\epsilon\)</span> with zero-point energy <span class="math notranslate nohighlight">\(\epsilon_0\)</span>. From this point onwards it is practical to use reduced temperature such that <span class="math notranslate nohighlight">\(k_B = 1\)</span>, and define that the energy levels <span class="math notranslate nohighlight">\(\epsilon_0,\epsilon_1, \epsilon_2,\dots, \epsilon_N\)</span> of the harmonic oscillator take integer values up to <span class="math notranslate nohighlight">\(N\)</span>.</p>
<p>We are particularly interested in the evolution of the distribution of microstates upon changing the temperature or degeneracy, thus in this exercise we will write a program to discover the Boltzmann distribution characteristics of the system.</p>
<figure class="align-default" id="harmonic-oscillator">
<img alt="../_images/harmonic_oscillator.png" src="../_images/harmonic_oscillator.png" />
<figcaption>
<p><span class="caption-number">Fig. 2.1 </span><span class="caption-text">Harmonic Oscillator with states <span class="math notranslate nohighlight">\(\Psi = \{\psi_0, \psi_1, \psi_2, \dots, \psi_N\}\)</span> and associated energies <span class="math notranslate nohighlight">\(E = \{\epsilon_0, \epsilon_1, \epsilon_2, \dots, \epsilon_N\}\)</span> CC by SA 3.0 <a class="reference external" href="https://commons.wikimedia.org/wiki/File:HarmOsziFunktionen.png">Leyo, Tomasz59</a>.</span><a class="headerlink" href="#harmonic-oscillator" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Ex2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="MDMC_ex2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Statistical Thermodynamics and the Boltzmann Distribution</p>
      </div>
    </a>
    <a class="right-next"
       href="Boltzmann.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.2. </span>Boltzmann Distribution Harmonic Oscillator</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">2.1.1. Background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-thermodynamics">2.1.1.1. Statistical Thermodynamics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-canonical-ensemble-and-the-canonical-partition-function">2.1.1.2. The Canonical Ensemble and the Canonical Partition Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-quantum-mechanical-partition-function-and-the-density-operator">2.1.1.3. The Quantum Mechanical Partition Function and the Density Operator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-isothermal-isobaric-ensemble">2.1.1.4. The Isothermal-Isobaric ensemble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamic-quantities-as-derivatives-of-the-canonical-partition-function">2.1.1.5. Thermodynamic Quantities as Derivatives of the Canonical Partition Function</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Laboratory of Computational Biochemistry and Chemistry - Ursula Roethlisberger
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>