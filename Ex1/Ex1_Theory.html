
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.1. From Quantum to Classical Mechanics: The Example of Forces &#8212; Molecular Dynamics and Monte Carlo</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"TeX": {"Macros": {"ket": ["\\lvert #1 \\rangle", 1], "bra": ["\\langle #1 \\lvert", 1], "Ket": ["\\lvert #1 \\rangle", 1], "Bra": ["\\langle #1 \\lvert", 1], "braket": ["\\langle #1 \\lvert #2 \\rangle", 2], "hop": "\\hat{\\mathcal{H}}", "unit": "\\mathbbm{1}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Ex1/Ex1_Theory';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.3. Monte Carlo \(\pi\)" href="MonteCarloPI.html" />
    <link rel="prev" title="1. Basic Concepts of Molecular Dynamics and Monte Carlo Simulations" href="MDMC_Ex1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Molecular Dynamics and Monte Carlo</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Molecular Dynamics and Monte Carlo
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="MDMC_Ex1.html">1. Basic Concepts of Molecular Dynamics and Monte Carlo Simulations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">1.1. From Quantum to Classical Mechanics: The Example of Forces</a></li>

<li class="toctree-l2"><a class="reference internal" href="MonteCarloPI.html">1.3. Monte Carlo <span class="math notranslate nohighlight">\(\pi\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="prng.html">1.4. Appendix: Random and Pseudo-random Numbers</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex2/MDMC_ex2.html">2. Statistical Thermodynamics and the Boltzmann Distribution</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex2/Ex2_Theory.html">2.1. Statistical Thermodynamics and the Boltzmann Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex2/Boltzmann.html">2.2. Boltzmann Distribution Harmonic Oscillator</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex3/MDMC_ex3.html">3. Monte Carlo Simulations and the Photon Gas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/Ex3_Theory.html">3.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/PhotonGas.html">3.2. The Photon Gas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/LJ_NVT.html">3.3. The Lennard-Jones Potential</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex4/MDMC_ex4.html">4. Introduction to Molecular Dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex4/Theory.html">4.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex4/Exercise.html">4.2. MD simulation from scratch</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex5/MDMC_ex5.html">5. Classical Molecular Dynamics (MD) Simulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/theory.html">5.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/Exercise.html">5.2. ToyMD</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex6/MDMC_ex6.html">6. Properties from Molecular Dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/theory.html">6.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/proteinmodelling.html">6.2. Protein Modelling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/TRP_Cage.html">6.3. Practical: TRP Cage using OpenMM</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Ex6/hydrogenbonds.html">6.5. TrpCage Analysis</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://noto.epfl.ch/hub/user-redirect/git-pull?repo=https%3A//github.com/lcbc-epfl/mdmc-public&urlpath=lab/tree/mdmc-public/mdmc/Ex1/Ex1_Theory.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/lcbc-epfl/mdmc-public/blob/main/mdmc/Ex1/Ex1_Theory.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lcbc-epfl/mdmc-public" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lcbc-epfl/mdmc-public/issues/new?title=Issue%20on%20page%20%2FEx1/Ex1_Theory.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Ex1/Ex1_Theory.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>From Quantum to Classical Mechanics: The Example of Forces</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">1.1. From Quantum to Classical Mechanics: The Example of Forces</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-approaches-to-numerical-estimation">1.2. Statistical Approaches to Numerical Estimation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-estimation-of-pi">1.2.1. Numerical Estimation of <span class="math notranslate nohighlight">\(\pi\)</span></a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="from-quantum-to-classical-mechanics-the-example-of-forces">
<h1><span class="section-number">1.1. </span>From Quantum to Classical Mechanics: The Example of Forces<a class="headerlink" href="#from-quantum-to-classical-mechanics-the-example-of-forces" title="Link to this heading">#</a></h1>
<p>Later in the course, you will learn that in <em>Molecular Dynamics</em>,
thermodynamic properties of a system are determined by propagating it in
time. This propagation is done by evaluating the forces acting on the
nuclei, which are usually considered to be classical particles. The
nuclei are then moved according to the forces which act on them. This
<em>clamped nuclei</em> approximation is also at the base of the geometry
optimisation procedures in electronic structure theory, as discussed in
the course ‘Introduction to Electronic Structure Methods’. Analogously,
in clamped-nuclei first-principles molecular dynamics, the information
on the forces is obtained from the electronic structure of the system by
solving the time-independent Schrödinger equation.</p>
<p>In classical mechanics, the forces acting on a system can be evaluated
from:</p>
<div class="math notranslate nohighlight" id="equation-forces">
<span class="eqno">(1.1)<a class="headerlink" href="#equation-forces" title="Link to this equation">#</a></span>\[ F(\mathbf{q}) = -\nabla E(\mathbf{q}).
\]</div>
<p>The link with the
time-independent Schrödinger equation is based on the Hellmann-Feynman
theorem:</p>
<div class="math notranslate nohighlight" id="equation-hellmanfeynman">
<span class="eqno">(1.2)<a class="headerlink" href="#equation-hellmanfeynman" title="Link to this equation">#</a></span>\[\begin{aligned}
\frac{\mathrm{d}E}{\mathrm{d}\lambda} = \left&lt;{\Psi_\lambda \left| \frac{\mathrm{d}\hat{\mathrm{H}}(\lambda)}{\mathrm{d}\lambda} \right| \Psi_\lambda} \right&gt;,\end{aligned}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda\)</span> is some parameter on which the Hamiltonian, and thus the
wavefunction, parametrically depends.</p>
<div class="exercise admonition">
<p class="admonition-title">Exercise 1</p>
<p>Prove the Hellmann-Feynman theorem</p>
</div>
<p>By considering the Hamiltonian of
a system with <span class="math notranslate nohighlight">\(N\)</span> electrons and <span class="math notranslate nohighlight">\(M\)</span> nuclei within the Born-Oppenheimer
approximation, the forces are easily evaluated from the Hellmann-Feynman
theorem.</p>
<p>The Hamiltonian reads:</p>
<div class="math notranslate nohighlight" id="equation-hamiltonian">
<span class="eqno">(1.3)<a class="headerlink" href="#equation-hamiltonian" title="Link to this equation">#</a></span>\[
\begin{aligned}
\mathrm{\hat{H}} = \mathrm{\hat{T}} + \mathrm{\hat{V}_{ee}} + \sum_{I=1}^M\sum_{i=1}^N \frac{Z_I}{\left|\mathbf{r}_i -\mathbf{R}_I\right|}
                  + \sum_{I=1}^M\sum_{J\ne I}^M \frac{Z_I Z_J}{\left|\mathbf{R}_I -\mathbf{R}_J \right|},
\end{aligned}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathrm{\hat{T}}\)</span> is the kinetic energy operator,
<span class="math notranslate nohighlight">\(\mathrm{\hat{V}_{ee}}\)</span> is the operator that mediates electron-electron
interactions, and captial and lower case letters denote nuclear and electronic indices respectively. In cartesian coordinates, the forces
acting on the x-component <span class="math notranslate nohighlight">\(\mathbf{X}_I\)</span> of nucleus <span class="math notranslate nohighlight">\(I\)</span> are:</p>
<div class="math notranslate nohighlight" id="equation-forces-x">
<span class="eqno">(1.4)<a class="headerlink" href="#equation-forces-x" title="Link to this equation">#</a></span>\[
\begin{aligned}
\mathbf{F}_{\mathbf{X}_I} = -\left&lt;{\Psi \left| \frac{\mathrm{d}\hat{\mathrm{H}}}{\mathrm{d}\mathbf{X}_I} \right| \Psi} \right&gt;.
\end{aligned}
\]</div>
<p>Insertion into <a class="reference internal" href="#equation-hamiltonian">(1.3)</a> yields:</p>
<div class="math notranslate nohighlight" id="equation-forces-x-hf">
<span class="eqno">(1.5)<a class="headerlink" href="#equation-forces-x-hf" title="Link to this equation">#</a></span>\[ 
\begin{aligned}
\mathbf{F}_{\mathbf{X}_I} = -Z_I \int \frac{\mathbf{x}-\mathbf{X}_I}{\left|\mathbf{r}-\mathbf{R}_I\right|^3}\rho(\mathbf{r}) \mathrm{d}\mathbf{r}
                          - \sum_{J \ne I}^M Z_I Z_J \frac{\mathbf{X}_J -\mathbf{X}_I}{\left| \mathbf{R}_J -\mathbf{R}_I \right|^3}.
\end{aligned}
\]</div>
<p>The forces on the nuclei are thus easily derived from the electron
density <span class="math notranslate nohighlight">\(\rho(\mathbf{r})\)</span> using an analytical expression. In <em>classical
molecular dynamics</em>, the forces are not evaluated from the electron
density, but are fully parametrised instead.</p>
<div class="exercise admonition">
<p class="admonition-title">Exercise 2 - Bonus</p>
<p>Explain the Born-Oppenheimer approximation in your own words.  You do not have to use any equations (but you may if you wish). Take care not to make wrong generalisations</p>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="statistical-approaches-to-numerical-estimation">
<h1><span class="section-number">1.2. </span>Statistical Approaches to Numerical Estimation<a class="headerlink" href="#statistical-approaches-to-numerical-estimation" title="Link to this heading">#</a></h1>
<p>Monte Carlo (MC) methods are a broad class of computational algorithms
which rely on repeated random sampling to obtain the distribution of an
unknown, often probabilistic entity. They are particularly useful for
problems in which it is difficult (or impossible) to obtain a
closed-form expression, or to apply a deterministic algorithm. A more
detailed discussion of MC methods will follow in the lecture course, but
here we intend to introduce the topic with a practical example.</p>
<p>One of the simplest yet intuitive examples of an MC method is to
estimate the value of <span class="math notranslate nohighlight">\(\pi\)</span> through numerical integration. This exercise
will focus on the importance of sampling and maintaining a uniform
distribution in the choice of sampling points. Since MC methods rely
heavily on uniform randomly distributed numbers, there is a detailed
discussion of pseudo-random number generators (PRNGs) in <a class="reference external" href="https://lcbc-epfl.github.io/mdmc-public/Ex1/prng.html">Appendix: Random and Pseudo-random Numbers</a></p>
<figure class="align-default" id="pi-estimation">
<a class="reference internal image-reference" href="../_images/Pi_estimation.svg"><img alt="../_images/Pi_estimation.svg" src="../_images/Pi_estimation.svg" style="height: 200px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1.1 </span><span class="caption-text">Schematic representation of modifying the l/d ratio. This ratio in part determines the accuracy of the <span class="math notranslate nohighlight">\(\pi\)</span> estimation.</span><a class="headerlink" href="#pi-estimation" title="Link to this image">#</a></p>
</figcaption>
</figure>
<section id="numerical-estimation-of-pi">
<h2><span class="section-number">1.2.1. </span>Numerical Estimation of <span class="math notranslate nohighlight">\(\pi\)</span><a class="headerlink" href="#numerical-estimation-of-pi" title="Link to this heading">#</a></h2>
<p>Consider a circle of diameter <span class="math notranslate nohighlight">\(d\)</span>, sitting at the centre of a square of
length <span class="math notranslate nohighlight">\(l\)</span> as depicted in <a class="reference internal" href="#pi-estimation"><span class="std std-numref">Fig. 1.1</span></a>. If points (x,y) are randomly distributed
within the square and those which fall within the circle versus the
square are counted, numerical integration is effectively being performed
<em>via</em> the MC method. The area ratio of the circle to the square thus
provides a route to estimate <span class="math notranslate nohighlight">\(\pi\)</span> explicitly. It is worthwhile to note
that in order to obtain an accurate approximation of <span class="math notranslate nohighlight">\(\pi\)</span>, the randomly
generated coordinates must be uniformly distributed across the entire
square to prevent bias. In addition, a large enough number of sample
points must be used to appropriately approximate the areas (and their
ratio).</p>
<div class="exercise admonition">
<p class="admonition-title">Exercise 3</p>
<p>How can you compute <span class="math notranslate nohighlight">\(\pi\)</span> using the ratio of points that fall within the circle (consider a full circle) and the square?</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "compchem"
        },
        kernelOptions: {
            name: "compchem",
            path: "./Ex1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'compchem'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="MDMC_Ex1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Basic Concepts of Molecular Dynamics and Monte Carlo Simulations</p>
      </div>
    </a>
    <a class="right-next"
       href="MonteCarloPI.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.3. </span>Monte Carlo <span class="math notranslate nohighlight">\(\pi\)</span></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">1.1. From Quantum to Classical Mechanics: The Example of Forces</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-approaches-to-numerical-estimation">1.2. Statistical Approaches to Numerical Estimation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-estimation-of-pi">1.2.1. Numerical Estimation of <span class="math notranslate nohighlight">\(\pi\)</span></a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Laboratory of Computational Biochemistry and Chemistry - Ursula Roethlisberger
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>