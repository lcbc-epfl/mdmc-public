
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4.1. Theory &#8212; Molecular Dynamics and Monte Carlo</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"TeX": {"Macros": {"ket": ["\\lvert #1 \\rangle", 1], "bra": ["\\langle #1 \\lvert", 1], "Ket": ["\\lvert #1 \\rangle", 1], "Bra": ["\\langle #1 \\lvert", 1], "braket": ["\\langle #1 \\lvert #2 \\rangle", 2], "hop": "\\hat{\\mathcal{H}}", "unit": "\\mathbbm{1}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Ex4/Theory';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.2. MD simulation from scratch" href="Exercise.html" />
    <link rel="prev" title="4. Introduction to Molecular Dynamics" href="MDMC_ex4.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Molecular Dynamics and Monte Carlo</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Molecular Dynamics and Monte Carlo
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex1/MDMC_Ex1.html">1. Basic Concepts of Molecular Dynamics and Monte Carlo Simulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex1/Ex1_Theory.html">1.1. From Quantum to Classical Mechanics: The Example of Forces</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Ex1/MonteCarloPI.html">1.3. Monte Carlo <span class="math notranslate nohighlight">\(\pi\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex1/prng.html">1.4. Appendix: Random and Pseudo-random Numbers</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex2/MDMC_ex2.html">2. Statistical Thermodynamics and the Boltzmann Distribution</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex2/Ex2_Theory.html">2.1. Statistical Thermodynamics and the Boltzmann Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex2/Boltzmann.html">2.2. Boltzmann Distribution Harmonic Oscillator</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex3/MDMC_ex3.html">3. Monte Carlo Simulations and the Photon Gas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/Ex3_Theory.html">3.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/PhotonGas.html">3.2. The Photon Gas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/LJ_NVT.html">3.3. The Lennard-Jones Potential</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="MDMC_ex4.html">4. Introduction to Molecular Dynamics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">4.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercise.html">4.2. MD simulation from scratch</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex5/MDMC_ex5.html">5. Classical Molecular Dynamics (MD) Simulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/theory.html">5.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/Exercise.html">5.2. ToyMD</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex6/MDMC_ex6.html">6. Properties from Molecular Dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/theory.html">6.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/proteinmodelling.html">6.2. Protein Modelling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/TRP_Cage_OpenMM_colab.html">6.3. Practical: TRP Cage using OpenMM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex6/hydrogenbonds.html">6.4. TrpCage Analysis</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://noto.epfl.ch/hub/user-redirect/git-pull?repo=https%3A//github.com/lcbc-epfl/mdmc-public&urlpath=lab/tree/mdmc-public/mdmc/Ex4/Theory.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/lcbc-epfl/mdmc-public/blob/main/mdmc/Ex4/Theory.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lcbc-epfl/mdmc-public" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lcbc-epfl/mdmc-public/issues/new?title=Issue%20on%20page%20%2FEx4/Theory.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Ex4/Theory.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Theory</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ergodic-hypothesis-in-statistical-mechanics">4.1.1. The Ergodic Hypothesis in Statistical Mechanics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-phase-space-using-molecular-dynamics">4.1.2. Sampling Phase Space using Molecular Dynamics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-evolution">4.1.3. Time Evolution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-position-verlet-algorithm">4.1.3.1. The Position-Verlet Algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-velocity-verlet-algorithm">4.1.3.2. The Velocity-Verlet Algorithm</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structural-properties-from-md">4.1.4. Structural Properties from MD</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#periodic-boundary-conditions">4.1.4.1. Periodic Boundary Conditions</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="theory">
<h1><span class="section-number">4.1. </span>Theory<a class="headerlink" href="#theory" title="Link to this heading">#</a></h1>
<section id="the-ergodic-hypothesis-in-statistical-mechanics">
<h2><span class="section-number">4.1.1. </span>The Ergodic Hypothesis in Statistical Mechanics<a class="headerlink" href="#the-ergodic-hypothesis-in-statistical-mechanics" title="Link to this heading">#</a></h2>
<p>The question whether some properties obtained by averaging over a
thermodynamical ensemble (the <em>ensemble average</em>) are equal to a <em>time
average</em> of said properties - <em>i.e.</em> whether a system is <em>ergodic</em> or
not - poses one of the fundamental problems of statistical mechanics.
Unfortunately, there exists no complete proof of an <em>ergodic theorem</em>
applied to thermodynamic ensembles. However, it can be shown that, if
the only constants of motion of the system are constant functions over
phase space (<em>i.e.</em> constants independent of coordinates and momenta),
then the ensemble and time averages are identical for
<span class="math notranslate nohighlight">\(t \rightarrow \infty\)</span>. Since a more general ergodic theorem has not
been proven yet, a system is usually considered ergodic as long as <em>all</em>
regions of phase space are accessible during the time <span class="math notranslate nohighlight">\(t\)</span> for which the
system is sampled. In practice, the <em>ergodic hypothesis</em>,</p>
<div class="math notranslate nohighlight" id="equation-ergodic-hypothesis">
<span class="eqno">(4.1)<a class="headerlink" href="#equation-ergodic-hypothesis" title="Link to this equation">#</a></span>\[
\begin{aligned}
\left&lt; O \right&gt; = \int_\Gamma \frac{1}{Z}O(\Gamma)e^{-\beta \mathrm{H}(\Gamma)} \mathrm{d}\Gamma
                 = \lim_{t \rightarrow \infty} \frac{1}{t} \int_0^t O(\tau) \mathrm{d}\tau,
\end{aligned}
\]</div>
<p>is thus assumed - but not guaranteed - to hold.</p>
</section>
<section id="sampling-phase-space-using-molecular-dynamics">
<h2><span class="section-number">4.1.2. </span>Sampling Phase Space using Molecular Dynamics<a class="headerlink" href="#sampling-phase-space-using-molecular-dynamics" title="Link to this heading">#</a></h2>
<p>Under the ergodic hypothesis, a direct sampling of phase space
configurations can be replaced by a sampling of the dynamic evolution of
the system for long enough times <span class="math notranslate nohighlight">\(t\)</span>. For an <span class="math notranslate nohighlight">\(NVT\)</span> ensemble, an
observable of a state <span class="math notranslate nohighlight">\(s\)</span> will then be explored with a probability
corresponding to its Boltzmann weight, and for a sufficiently long <span class="math notranslate nohighlight">\(t\)</span> -
<em>i.e.</em> for a sufficiently high occurence of all events to be
representative - the time-average over the <span class="math notranslate nohighlight">\(O(s)\)</span> will reproduce the
ensemble average. The longer the simulation time <span class="math notranslate nohighlight">\(t\)</span> is chosen, the
better the convergence of the time average towards the ensemble average
(it is evident that too short <span class="math notranslate nohighlight">\(t\)</span> do not lead to a converged dynamics,
<em>i.e.</em> phase space is not properly sampled).</p>
<p>In this spirit, a (suitable) starting conformer of a system can be
propagated in time according to Hamilton’s equations of motions:</p>
<div class="math notranslate nohighlight" id="equation-hamiltoneqmotion">
<span class="eqno">(4.2)<a class="headerlink" href="#equation-hamiltoneqmotion" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
 \frac{\mathrm{d}\mathbf{p}_i}{\mathrm{d}t} &amp;= -\frac{\partial{H}}{\partial{\mathbf{q}_i}},\\
 \frac{\mathrm{d}\mathbf{q}_i}{\mathrm{d}t} &amp;= \frac{\partial{H}}{\partial{\mathbf{p}_i}}.
 \end{aligned}
 \end{split}\]</div>
<p>This time-evolution is completely general. If the system is represented
by a set of classical point particles, the Newtonian formulation of
classical mechanics can be applied to the problem, and the particles can
be propagated by evaluating the force acting on them:</p>
<div class="math notranslate nohighlight" id="equation-newtonianformulation">
<span class="eqno">(4.3)<a class="headerlink" href="#equation-newtonianformulation" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
\mathbf{F}_I &amp;= \nabla_I E\\
&amp;= m_I\mathbf{a}_I
\end{aligned} \end{split}\]</div>
<p>For small time steps
<span class="math notranslate nohighlight">\(\Delta t = \tau\)</span>, the particles are accelerated according to <span class="math notranslate nohighlight">\(a\)</span> which
is determined from <span class="math notranslate nohighlight">\(\frac{\nabla_I E}{m_I}\)</span> at <span class="math notranslate nohighlight">\(t=0\)</span>. At time <span class="math notranslate nohighlight">\(t=\tau\)</span>,
the forces and the acceleration are re-evaluated, and the system is
moved according to the updated forces that act on it. These forces may
be obtained from quantum mechanical calculations (<em>first principles</em>
dynamics, <em>cf.</em> the discussion of the Hellmann-Feynman theorem) or from
a parametrised form for <span class="math notranslate nohighlight">\(E(\mathbf{r})\)</span> (<em>classical dynamics</em>, which
will be discussed in detail in the following lecture). Since the
evolution of the system is well-defined at every point based on the
forces acting on it, its dynamics will be <em>deterministic</em>. Given an
initial set of positions and momenta, every point ever visited by the
system at time <span class="math notranslate nohighlight">\(t\)</span> is pre-determined. Applying this approach to
molecular systems results in either <em>classical</em> or <em>first-principles
molecular dynamics</em> (MD).</p>
</section>
<section id="time-evolution">
<h2><span class="section-number">4.1.3. </span>Time Evolution<a class="headerlink" href="#time-evolution" title="Link to this heading">#</a></h2>
<p>Given the potential for atomic interaction in section
<a class="reference internal" href="../Ex5/theory.html#minimalff"><span class="std std-numref">Section 5.1.4</span></a>, the force
acting upon the <span class="math notranslate nohighlight">\(i\)</span>th atom is determined by the gradient with respect to
atomic displacements:</p>
<div class="math notranslate nohighlight" id="equation-force-on-i">
<span class="eqno">(4.4)<a class="headerlink" href="#equation-force-on-i" title="Link to this equation">#</a></span>\[
\mathbf{F}_i = -\nabla_{\mathbf{r}_i} V \left( \mathbf{r_1}, \dots, \mathbf{r_N} \right) = - \left( \frac{\partial V}{\partial x_i}, \frac{\partial V}{\partial y_i}, \frac{\partial V}{\partial z_i} \right).
\]</div>
<p>Using Newton’s equations of motion one can then achieve propagation of
atomic positions in time, using some time step <span class="math notranslate nohighlight">\(\Delta t\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-atomic-position-in-time">
<span class="eqno">(4.5)<a class="headerlink" href="#equation-atomic-position-in-time" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
\mathbf{a_i}(r_i, t) &amp;= \frac{\mathbf{F}_i(\mathbf{r})}{m_i}, \\
\mathbf{v}_i(t + \Delta t) &amp;= \mathbf{v}_i(t) + \mathbf{a}_i(t)\Delta t, \\
\mathbf{r}_i(t + \Delta t) &amp;= \mathbf{r}_i(t) + \mathbf{v}_i(t)\Delta t.
\end{aligned}
\end{split}\]</div>
<section id="the-position-verlet-algorithm">
<h3><span class="section-number">4.1.3.1. </span>The Position-Verlet Algorithm<a class="headerlink" href="#the-position-verlet-algorithm" title="Link to this heading">#</a></h3>
<p>The potential energy
<span class="math notranslate nohighlight">\(U \left( \mathbf{r_1}, \dots, \mathbf{r_N} \right)\)</span> is a function of
the positions (3N) of all atoms in the system. Due to the complicated
nature of this function and the large number of atoms typically modeled
in classical systems, there is no analytical solution to the equations
of motion, and hence these must be solved numerically. The most common
numerical solutions to integrating the equations of motion are called
finite difference methods. First, the positions, velocities and
accelerations can be approximated by a Taylor series expansion:</p>
<div class="math notranslate nohighlight" id="equation-taylor-exp-verlet">
<span class="eqno">(4.6)<a class="headerlink" href="#equation-taylor-exp-verlet" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
\mathbf{r}(t + \Delta t) &amp;= \mathbf{r}(t) + \mathbf{v}(t)\Delta t + \frac{1}{2}\mathbf{a}(t)\Delta t^2 + \dots, \\
\mathbf{v}(t + \Delta t) &amp;= \mathbf{v}(t) + \mathbf{a}(t)\Delta t + \frac{1}{2}\mathbf{b}(t)\Delta t^2 + \dots, \\
\mathbf{a}(t + \Delta t) &amp;= \mathbf{a}(t) + \mathbf{b}(t)\Delta t + \dots,
\end{aligned}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\dots\)</span> denotes higher order derivatives of <span class="math notranslate nohighlight">\(\mathbf{r}(t)\)</span>. One
can then propagate the position function forwards and backwards in time,
yielding:</p>
<div class="math notranslate nohighlight" id="equation-step3">
<span class="eqno">(4.7)<a class="headerlink" href="#equation-step3" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
\mathbf{r}(t + \Delta t) &amp;= \mathbf{r}(t) + \mathbf{v}(t)\Delta t + \frac{1}{2}\mathbf{a}(t)\Delta t^2, \\
\mathbf{r}(t - \Delta t) &amp;= \mathbf{r}(t) - \mathbf{v}(t)\Delta t + \frac{1}{2}\mathbf{a}(t)\Delta t^2, \\
\end{aligned}
\end{split}\]</div>
<p>and by summing these the position-Verlet is obtained:</p>
<div class="math notranslate nohighlight" id="equation-step2">
<span class="eqno">(4.8)<a class="headerlink" href="#equation-step2" title="Link to this equation">#</a></span>\[
\mathbf{r}(t + \Delta t) = 2\mathbf{r}(t) - \mathbf{r}(t - \Delta t) + \mathbf{a}(t) \Delta t^2,
\]</div>
<p>while the subtraction of the Taylor series for
<span class="math notranslate nohighlight">\(\mathbf{r}(t + \Delta t)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{r}(t - \Delta t)\)</span> yields:</p>
<div class="math notranslate nohighlight" id="equation-step1">
<span class="eqno">(4.9)<a class="headerlink" href="#equation-step1" title="Link to this equation">#</a></span>\[
\mathbf{v}(t) = \frac{\mathbf{r}(t + \Delta t) - \mathbf{r}(t - \Delta t)}{2 \Delta t}.
\]</div>
</section>
<section id="the-velocity-verlet-algorithm">
<h3><span class="section-number">4.1.3.2. </span>The Velocity-Verlet Algorithm<a class="headerlink" href="#the-velocity-verlet-algorithm" title="Link to this heading">#</a></h3>
<p>The position-Verlet algorithm uses positions and accelerations at time
<span class="math notranslate nohighlight">\(t\)</span>, and the positions from time <span class="math notranslate nohighlight">\(t- \Delta t\)</span> to calculate new
positions at time <span class="math notranslate nohighlight">\(t+\Delta t\)</span>. The position-Verlet algorithm does not
use velocities explicitly, and as such it is straightforward to
implement and requires minimal storage space. However, this form of the
Verlet algorithm is not self-starting, i.e it requires two time steps
before propagation can take place, and as such is heavily dependent on
initial starting conditions. A modification to the above is the
velocity-Verlet:</p>
<div class="math notranslate nohighlight" id="equation-velocity-verlet">
<span class="eqno">(4.10)<a class="headerlink" href="#equation-velocity-verlet" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
\mathbf{r}(t + \Delta t) &amp;= \mathbf{r}(t) + \mathbf{v}(t)\Delta t + \frac{1}{2}\mathbf{a}(t)\Delta t^2, \\
\mathbf{v}(t + \Delta t) &amp;= \mathbf{v}(t) + \frac{1}{2} \left( \mathbf{a}(t + \Delta t) + \mathbf{a}(t) \right) \Delta t,
\end{aligned}
\end{split}\]</div>
<p>which is self-starting and additionally minimises round-off errors.</p>
<div class="exercise admonition">
<p class="admonition-title">Exercise 1</p>
<p>Derive the form of <span class="math notranslate nohighlight">\(\mathbf{r}(t + \Delta t)\)</span> in the velocity-Verlet
<a class="reference internal" href="#equation-velocity-verlet">(4.10)</a>. <strong>Hint</strong>: solve equation  <a class="reference internal" href="#equation-step1">(4.9)</a> for  <span class="math notranslate nohighlight">\(\mathbf{r}(t - \Delta t)\)</span>, and use equations <a class="reference internal" href="#equation-step2">(4.8)</a> and  <a class="reference internal" href="#equation-step3">(4.7)</a>.</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 2</p>
<p>Derive the form of <span class="math notranslate nohighlight">\(\mathbf{v}(t + \Delta t)\)</span> in the velocity-Verlet  <a class="reference internal" href="#equation-velocity-verlet">(4.10)</a>. <strong>Hint</strong>: recast equations  <a class="reference internal" href="#equation-step1">(4.9)</a> and <a class="reference internal" href="#equation-step2">(4.8)</a> to a  timestep <span class="math notranslate nohighlight">\(\Delta t\)</span> in the future, and use the result obtained  above.</p>
</div>
</section>
</section>
<section id="structural-properties-from-md">
<h2><span class="section-number">4.1.4. </span>Structural Properties from MD<a class="headerlink" href="#structural-properties-from-md" title="Link to this heading">#</a></h2>
<section id="periodic-boundary-conditions">
<h3><span class="section-number">4.1.4.1. </span>Periodic Boundary Conditions<a class="headerlink" href="#periodic-boundary-conditions" title="Link to this heading">#</a></h3>
<p>Simulating for long times <span class="math notranslate nohighlight">\(t\)</span> ensures that the ensemble average can be
approached, however, it is impossible to sample in the limit of the
ergodic theorem <span class="math notranslate nohighlight">\(t\to\infty\)</span>. Additionally, for bulk-property
calculation it is necessary to use a sufficiently large number of
molecules to ensure that regions of phase space are sampled
representatively, such that one may be confident that the ensemble
average is properly reconstructed from the time average. In practice
there is a relatively small and finite number of molecules for which
simulation is computationally feasible, hence, compared to a macroscopic
system (<span class="math notranslate nohighlight">\(\sum N_A\)</span> molecules), the ratio of molecules near the surface
of the simulation box is often too large to be representative.
Computational modelling of molecular systems could therefore have an
artificially imposed doping of surface effects which negatively impacts
the calculation of any bulk property of interest. To remedy this, surface
effects can be disposed of for all system sizes if periodic boundary
conditions (PBC) are imposed. In this regime, the simulation box is
replicated through space to form an infinite lattice. When a molecule
moves during simulation its periodic images move with the exact same
displacement, thus, if a molecule leaves the central box, one of its
images will enter through the opposite face. This is illustrated in
Figure <a class="reference internal" href="#pbc"><span class="std std-numref">Fig. 4.1</span></a> there
are no walls at the boundary of the central box and the system has no
surface.</p>
<figure class="align-default" id="pbc">
<a class="reference internal image-reference" href="../_images/pbc.svg"><img alt="../_images/pbc.svg" src="../_images/pbc.svg" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.1 </span><span class="caption-text">Simulation box and its periodic images. When a molecule leaves the
central box, it is wrapped around to the opposite side. CC by SA <a class="reference external" href="https://commons.wikimedia.org/wiki/File:Limiteperiodicite.svg">Grimlock</a></span><a class="headerlink" href="#pbc" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>It is not necessary to store the coordinates of all images in a
simulation (this would require infinite space). When a molecule leaves
the box by crossing a boundary, attention may be switched to the
identical molecule entering from the opposite side (see Exercise).</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Ex4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="MDMC_ex4.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Introduction to Molecular Dynamics</p>
      </div>
    </a>
    <a class="right-next"
       href="Exercise.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.2. </span>MD simulation from scratch</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ergodic-hypothesis-in-statistical-mechanics">4.1.1. The Ergodic Hypothesis in Statistical Mechanics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-phase-space-using-molecular-dynamics">4.1.2. Sampling Phase Space using Molecular Dynamics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-evolution">4.1.3. Time Evolution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-position-verlet-algorithm">4.1.3.1. The Position-Verlet Algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-velocity-verlet-algorithm">4.1.3.2. The Velocity-Verlet Algorithm</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structural-properties-from-md">4.1.4. Structural Properties from MD</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#periodic-boundary-conditions">4.1.4.1. Periodic Boundary Conditions</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Laboratory of Computational Biochemistry and Chemistry - Ursula Roethlisberger
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>