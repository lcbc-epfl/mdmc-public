
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6.3. Practical: TRP Cage using OpenMM &#8212; Molecular Dynamics and Monte Carlo</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.4. TrpCage Analysis" href="hydrogenbonds.html" />
    <link rel="prev" title="6.2. Protein Modelling" href="proteinmodelling.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Molecular Dynamics and Monte Carlo</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Molecular Dynamics and Monte Carlo
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Exercises
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex1/MDMC_ex1.html">
   1. Basic Concepts of Molecular Dynamics and Monte Carlo Simulations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/Ex1_Theory.html">
     1.1. From Quantum to Classical Mechanics: The Example of Forces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/MonteCarloPI.html">
     1.3. Monte Carlo
     <span class="math notranslate nohighlight">
      \(\pi\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/prng.html">
     1.4. Appendix: Random and Pseudo-random Numbers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex2/MDMC_ex2.html">
   2. Statistical Thermodynamics and the Boltzmann Distribution
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex2/Ex2_Theory.html">
     2.1. Statistical Thermodynamics and the Boltzmann Distribution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex2/Boltzmann.html">
     2.2. Boltzmann Distribution Harmonic Oscillator
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex3/MDMC_ex3.html">
   3. Monte Carlo Simulations and the Photon Gas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3_Theory.html">
     3.1. Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/PhotonGas.html">
     3.2. The Photon Gas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/LJ_NVT.html">
     3.3. The Lennard-Jones Potential
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex4/MDMC_ex4.html">
   4. Introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/Theory.html">
     4.1. Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/Exercise.html">
     4.2. MD simulation from scratch
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex5/MDMC_ex5.html">
   5. Classical Molecular Dynamics (MD) Simulations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex5/theory.html">
     5.1. Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex5/Exercise.html">
     5.2. ToyMD
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="MDMC_ex6.html">
   6. Properties from Molecular Dynamics
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="theory.html">
     6.1. Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="proteinmodelling.html">
     6.2. Protein Modelling
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6.3. Practical: TRP Cage using OpenMM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hydrogenbonds.html">
     6.4. TrpCage Analysis
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://noto.epfl.ch/hub/user-redirect/git-pull?repo=https%3A//github.com/lcbc-epfl/mdmc-public&urlpath=lab/tree/mdmc-public/mdmc/Ex6/TRP_Cage_OpenMM_colab.ipynb&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/lcbc-epfl/mdmc-public/blob/main/mdmc/Ex6/TRP_Cage_OpenMM_colab.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/lcbc-epfl/mdmc-public"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/lcbc-epfl/mdmc-public/issues/new?title=Issue%20on%20page%20%2FEx6/TRP_Cage_OpenMM_colab.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Ex6/TRP_Cage_OpenMM_colab.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   6.3.1. Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-our-system">
   6.3.2. Creating our system
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#looking-at-the-starting-structure">
     6.3.2.1. Looking at the starting structure
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulating-the-system">
   6.3.3. Simulating the system
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loading-amber-files">
     6.3.3.1. Loading Amber files
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-the-openmm-system">
     6.3.3.2. Create the OpenMM System
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-the-integrator-to-do-langevin-dynamics">
     6.3.3.3. Create the integrator to do Langevin Dynamics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-the-simulation-object">
     6.3.3.4. Create the
     <code class="docutils literal notranslate">
      <span class="pre">
       Simulation
      </span>
     </code>
     object
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#minimize-the-energy">
     6.3.3.5. Minimize the energy
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#heating-phase">
     6.3.3.6. Heating phase
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-dynamics">
   6.3.4. Running dynamics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#save-trajectory-for-later-processing">
   6.3.5. Save trajectory for later processing
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Practical: TRP Cage using OpenMM</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   6.3.1. Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-our-system">
   6.3.2. Creating our system
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#looking-at-the-starting-structure">
     6.3.2.1. Looking at the starting structure
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulating-the-system">
   6.3.3. Simulating the system
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loading-amber-files">
     6.3.3.1. Loading Amber files
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-the-openmm-system">
     6.3.3.2. Create the OpenMM System
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-the-integrator-to-do-langevin-dynamics">
     6.3.3.3. Create the integrator to do Langevin Dynamics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-the-simulation-object">
     6.3.3.4. Create the
     <code class="docutils literal notranslate">
      <span class="pre">
       Simulation
      </span>
     </code>
     object
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#minimize-the-energy">
     6.3.3.5. Minimize the energy
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#heating-phase">
     6.3.3.6. Heating phase
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-dynamics">
   6.3.4. Running dynamics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#save-trajectory-for-later-processing">
   6.3.5. Save trajectory for later processing
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><strong>Note</strong> This tutorial should be run on Google Colab and not on JupyterHub.</p>
<p>Change the runtime to use a GPU by selecting <code class="docutils literal notranslate"><span class="pre">Runtime</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Change</span> <span class="pre">Runtime</span> <span class="pre">type</span></code> -&gt; select <code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
<section class="tex2jax_ignore mathjax_ignore" id="practical-trp-cage-using-openmm">
<h1><span class="section-number">6.3. </span>Practical: TRP Cage using OpenMM<a class="headerlink" href="#practical-trp-cage-using-openmm" title="Permalink to this headline">#</a></h1>
<p>We will use a modern and open source simulation program to run our molecular dynamics simulation of the TRP cage protein.</p>
<p>OpenMM is different from most other simulations tools in that it is not controlled by executing different subprograms in the command line but instead one uses a python program to control the flow of our simulation. This allows us to easily rerun parts or the whole simulation.</p>
<p>Below is a detailed description of our workflow. The respective parts you need to change during the exercise are indicated.</p>
<section id="imports">
<h2><span class="section-number">6.3.1. </span>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">#</a></h2>
<p>First we need to install the necessary modules and import them.  We install our simulation package openmm and parmed, which we use to load our Amber trajectory files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment below code on Colab</span>

<span class="c1">#!pip install -q condacolab</span>
<span class="c1">#import condacolab</span>
<span class="c1">#condacolab.install()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment on google colab </span>

<span class="c1">#!conda install openmm ambertools=20 &amp;&gt; /dev/null  </span>
<span class="c1">#!pip install py3Dmol</span>
<span class="c1"># The last part simply makes the command silent. Remove &amp;&gt; /dev/null  if there are problems</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">py3Dmol</span>
</pre></div>
</div>
</div>
</div>
<div class="exercise admonition" id="ex4">
<p class="admonition-title">Exercise 4</p>
<p>Follow the instructions in this file and run the folding simulation.
Calculate the correct number of steps for the simulations to run 50 ps of heating and 20 ns of dynamics and report those numbers in your report. These sections are marked in the following with <code class="docutils literal notranslate"><span class="pre">#CHANGE</span> <span class="pre">HERE</span></code>.</p>
</div>
</section>
<section id="creating-our-system">
<h2><span class="section-number">6.3.2. </span>Creating our system<a class="headerlink" href="#creating-our-system" title="Permalink to this headline">#</a></h2>
<p>Creating the system will be done using tleap which is part of the Amber software package. Linear peptides can be easily created using this tool.</p>
<p>Below we create this file using python and save it as <code class="docutils literal notranslate"><span class="pre">leap.in</span></code> to the filesystem.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">!cat</span> <span class="pre">filename</span></code> we can check whether it was sucessfully created.</p>
<p>Then we execute tleap using our input file using the command <code class="docutils literal notranslate"><span class="pre">!tleap</span> <span class="pre">-f</span> <span class="pre">leap.in</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leapin</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;source leaprc.protein.ff19SB</span>
<span class="s2">  set default PBradii mbondi3</span>
<span class="s2">  TRP = sequence {  NASN LEU TYR ILE GLN TRP LEU LYS ASP GLY GLY PRO SER SER GLY ARG PRO PRO PRO CSER}</span>
<span class="s2">  savepdb TRP trp_cage_linear.pdb</span>
<span class="s2">  saveamberparm TRP trp_cage.prmtop trp_cage_linear.nc</span>
<span class="s2">  quit</span>
<span class="s2">  &quot;&quot;&quot;</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;leap.in&quot;</span><span class="p">,</span><span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">leapin</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>cat<span class="w"> </span>leap.in
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>tleap<span class="w"> </span>-f<span class="w"> </span>leap.in
</pre></div>
</div>
</div>
</div>
<p>You will be greeted with plenty output, lets go through it step by step.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;$ tleap
-I: Adding /home/packages/amber20/dat/leap/prep to search path.
-I: Adding /home/packages/amber20/dat/leap/lib to search path.
-I: Adding /home/packages/amber20/dat/leap/parm to search path.
-I: Adding /home/packages/amber20/dat/leap/cmd to search path.
Welcome to LEaP!
&gt;(no leaprc in search path)
</pre></div>
</div>
<p>This is leap starting up telling us that it has added several directories to its search path. These directories contain the parameters of the amber force field that we now will load.</p>
<p>Next we need to load a specific force field.
We do this using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="n">leaprc</span><span class="o">.</span><span class="n">protein</span><span class="o">.</span><span class="n">ff19SB</span>
</pre></div>
</div>
<p>If you want you can take a look at this file
you can make a new cell and use the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">!cat</span>&#160; <span class="pre">/usr/local/dat/leap/parm/parm19.dat</span></code></p>
<p>Here you will find the masses, bond distance and force constants etc. that make up our forcefield.</p>
<p>This produces the following output which are all force field parameters that are loaded.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-----</span> <span class="n">Source</span><span class="p">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">dat</span><span class="o">/</span><span class="n">leap</span><span class="o">/</span><span class="n">cmd</span><span class="o">/</span><span class="n">leaprc</span><span class="o">.</span><span class="n">protein</span><span class="o">.</span><span class="n">ff19SB</span>
<span class="o">-----</span> <span class="n">Source</span> <span class="n">of</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">dat</span><span class="o">/</span><span class="n">leap</span><span class="o">/</span><span class="n">cmd</span><span class="o">/</span><span class="n">leaprc</span><span class="o">.</span><span class="n">protein</span><span class="o">.</span><span class="n">ff19SB</span> <span class="n">done</span>
<span class="n">Log</span> <span class="n">file</span><span class="p">:</span> <span class="o">./</span><span class="n">leap</span><span class="o">.</span><span class="n">log</span>
<span class="n">Loading</span> <span class="n">parameters</span><span class="p">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">dat</span><span class="o">/</span><span class="n">leap</span><span class="o">/</span><span class="n">parm</span><span class="o">/</span><span class="n">parm19</span><span class="o">.</span><span class="n">dat</span>
<span class="n">Reading</span> <span class="n">title</span><span class="p">:</span>
<span class="n">PARM99</span> <span class="o">+</span> <span class="n">frcmod</span><span class="o">.</span><span class="n">ff99SB</span> <span class="o">+</span> <span class="n">frcmod</span><span class="o">.</span><span class="n">parmbsc0</span> <span class="o">+</span> <span class="n">OL3</span> <span class="k">for</span> <span class="n">RNA</span> <span class="o">+</span> <span class="n">ff19SB</span>
<span class="n">Loading</span> <span class="n">parameters</span><span class="p">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">dat</span><span class="o">/</span><span class="n">leap</span><span class="o">/</span><span class="n">parm</span><span class="o">/</span><span class="n">frcmod</span><span class="o">.</span><span class="n">ff19SB</span>
<span class="n">Reading</span> <span class="n">force</span> <span class="n">field</span> <span class="n">modification</span> <span class="nb">type</span> <span class="n">file</span> <span class="p">(</span><span class="n">frcmod</span><span class="p">)</span>
<span class="n">Reading</span> <span class="n">title</span><span class="p">:</span>
<span class="n">ff19SB</span> <span class="n">AA</span><span class="o">-</span><span class="n">specific</span> <span class="n">backbone</span> <span class="n">CMAPs</span> <span class="k">for</span> <span class="n">protein</span> <span class="mi">07</span><span class="o">/</span><span class="mi">25</span><span class="o">/</span><span class="mi">2019</span>
<span class="n">Loading</span> <span class="n">library</span><span class="p">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">dat</span><span class="o">/</span><span class="n">leap</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">amino19</span><span class="o">.</span><span class="n">lib</span>
<span class="n">Loading</span> <span class="n">library</span><span class="p">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">dat</span><span class="o">/</span><span class="n">leap</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">aminoct12</span><span class="o">.</span><span class="n">lib</span>
<span class="n">Loading</span> <span class="n">library</span><span class="p">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">dat</span><span class="o">/</span><span class="n">leap</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">aminont12</span><span class="o">.</span><span class="n">lib</span>
</pre></div>
</div>
<p>In the next line, we set the radii of the atoms to be used for the implicit solvation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">default</span> <span class="n">PBradii</span> <span class="n">mbondi3</span>
</pre></div>
</div>
<p>This produces the following line in the leap output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Using</span> <span class="n">ArgH</span> <span class="ow">and</span> <span class="n">AspGluO</span> <span class="n">modified</span> <span class="n">Bondi2</span> <span class="n">radii</span>
</pre></div>
</div>
<p>Next, we create a new UNIT in AMBER using the <code class="docutils literal notranslate"><span class="pre">sequence</span></code> command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TRP</span> <span class="o">=</span> <span class="n">sequence</span> <span class="p">{</span>  <span class="n">NASN</span> <span class="n">LEU</span> <span class="n">TYR</span> <span class="n">ILE</span> <span class="n">GLN</span> <span class="n">TRP</span> <span class="n">LEU</span> <span class="n">LYS</span> <span class="n">ASP</span> <span class="n">GLY</span> <span class="n">GLY</span> <span class="n">PRO</span> <span class="n">SER</span> <span class="n">SER</span> <span class="n">GLY</span> <span class="n">ARG</span> <span class="n">PRO</span> <span class="n">PRO</span> <span class="n">PRO</span> <span class="n">CSER</span><span class="p">}</span>
</pre></div>
</div>
<p>Then, we save a PDB file of our system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">savepdb</span> <span class="n">TRP</span> <span class="n">trp_cage_linear</span><span class="o">.</span><span class="n">pdb</span>
</pre></div>
</div>
<p>This creates the pdb file on disk and produces the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Writing pdb file: trp_cage_linear.pdb

/usr/local/bin/teLeap: Warning!
 Converting N-terminal residue name to PDB format: NASN -&gt; ASN

/usr/local/bin/teLeap: Warning!
 Converting C-terminal residue name to PDB format: CSER -&gt; SER
Checking Unit.
</pre></div>
</div>
<p>As you can see, the N and C-terminal residues have a different residue namer in AMBER compared e.g to a normal serine. This is due to the fact that here the force field parameters slightly deviate from the parameters of a serine involved in two peptide bonds versus one single peptide bond for a terminal uncapped serine.</p>
<p>In the last step, we now generate the parameters in AMBER format and the input coordinates in the NetCDF format (which is a binary format).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">saveamberparm</span> <span class="n">TRP</span> <span class="n">trp_cage</span><span class="o">.</span><span class="n">prmtop</span> <span class="n">trp_cage_linear</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
<p>This produces plenty of output and a warning:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/usr/local/bin/teLeap: Warning!
The unperturbed charge of the unit (1.000000) is not zero.

/usr/local/bin/teLeap: Note.
Ignoring the warning from Unit Checking.

Building topology.
Building atom parameters.
Building bond parameters.
Building angle parameters.
Building proper torsion parameters.
Building improper torsion parameters.
 total 63 improper torsions applied
Building H-Bond parameters.
Incorporating Non-Bonded adjustments.
Not Marking per-residue atom chain types.
Marking per-residue atom chain types.
  (Residues lacking connect0/connect1 - 
   these don&#39;t have chain types marked:

	res	total affected

	CSER	1
	NASN	1
  )
 (no restraints)
</pre></div>
</div>
<p>The first warning we can safely ignore as in the implicit solvent treatment we will use, we cannot use counter ions to neutralize our system. Instead we will use a screened charge model to emulate the presence of ions in the solvent.
Next we see terms, that align with the functional form of the AMBER forcefield:</p>
<p><img alt="" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fdc7cf40fe4d2f568921977c83e49f699d780e92" />
<img alt="" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7c7949ed189c2add713405eb21fe5adcbda09ca0" />
<img alt="" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2d244cd7f2e174af73dfc1e4dd0b37083115b690" /></p>
<p>Again, we can look at the contents of the parameter file <code class="docutils literal notranslate"><span class="pre">!cat</span> <span class="pre">trp_cage.prmtop</span></code> and we see that it does not contain the coordinates anymore in contrast to the pdb file.</p>
<section id="looking-at-the-starting-structure">
<h3><span class="section-number">6.3.2.1. </span>Looking at the starting structure<a class="headerlink" href="#looking-at-the-starting-structure" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show starting structure here</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;trp_cage_linear.pdb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ifile</span><span class="p">:</span>
    <span class="n">system</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ifile</span><span class="p">])</span>

<span class="n">view</span> <span class="o">=</span> <span class="n">py3Dmol</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">addModelsAsFrames</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;stick&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;spectrum&#39;</span><span class="p">}})</span>
<span class="n">view</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">()</span>
<span class="n">view</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_1651750336480033"  style="position: relative; width: 400px; height: 300px">
        <p id="3dmolwarning_1651750336480033" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
      resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://3dmol.org/build/3Dmol.js');
}

var viewer_1651750336480033 = null;
var warn = document.getElementById("3dmolwarning_1651750336480033");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1651750336480033 = $3Dmol.createViewer($("#3dmolviewer_1651750336480033"),{backgroundColor:"white"});
viewer_1651750336480033.zoomTo();
	viewer_1651750336480033.addModelsAsFrames("ATOM      1  N   ASN     1       3.326   1.548  -0.000  1.00  0.00\nATOM      2  H1  ASN     1       4.046   0.840  -0.000  1.00  0.00\nATOM      3  H2  ASN     1       2.823   1.500  -0.875  1.00  0.00\nATOM      4  H3  ASN     1       2.823   1.500   0.875  1.00  0.00\nATOM      5  CA  ASN     1       3.970   2.846  -0.000  1.00  0.00\nATOM      6  HA  ASN     1       3.672   3.400  -0.890  1.00  0.00\nATOM      7  CB  ASN     1       3.577   3.654   1.232  1.00  0.00\nATOM      8  HB2 ASN     1       2.497   3.801   1.241  1.00  0.00\nATOM      9  HB3 ASN     1       3.877   3.116   2.131  1.00  0.00\nATOM     10  CG  ASN     1       4.254   5.017   1.232  1.00  0.00\nATOM     11  OD1 ASN     1       5.005   5.340   0.315  1.00  0.00\nATOM     12  ND2 ASN     1       3.985   5.818   2.266  1.00  0.00\nATOM     13 HD21 ASN     1       4.408   6.734   2.315  1.00  0.00\nATOM     14 HD22 ASN     1       3.360   5.504   2.994  1.00  0.00\nATOM     15  C   ASN     1       5.486   2.705  -0.000  1.00  0.00\nATOM     16  O   ASN     1       6.009   1.593  -0.000  1.00  0.00\nATOM     17  N   LEU     2       6.191   3.839  -0.000  1.00  0.00\nATOM     18  H   LEU     2       5.715   4.730  -0.000  1.00  0.00\nATOM     19  CA  LEU     2       7.640   3.839  -0.000  1.00  0.00\nATOM     20  HA  LEU     2       8.004   3.325   0.890  1.00  0.00\nATOM     21  CB  LEU     2       8.189   3.127  -1.232  1.00  0.00\nATOM     22  HB2 LEU     2       7.841   2.094  -1.241  1.00  0.00\nATOM     23  HB3 LEU     2       7.841   3.636  -2.131  1.00  0.00\nATOM     24  CG  LEU     2       9.713   3.149  -1.195  1.00  0.00\nATOM     25  HG  LEU     2      10.062   4.181  -1.186  1.00  0.00\nATOM     26  CD1 LEU     2      10.201   2.437   0.063  1.00  0.00\nATOM     27 HD11 LEU     2       9.853   1.404   0.055  1.00  0.00\nATOM     28 HD12 LEU     2      11.291   2.452   0.090  1.00  0.00\nATOM     29 HD13 LEU     2       9.809   2.945   0.944  1.00  0.00\nATOM     30  CD2 LEU     2      10.262   2.438  -2.427  1.00  0.00\nATOM     31 HD21 LEU     2       9.914   2.946  -3.326  1.00  0.00\nATOM     32 HD22 LEU     2      11.352   2.453  -2.400  1.00  0.00\nATOM     33 HD23 LEU     2       9.914   1.405  -2.436  1.00  0.00\nATOM     34  C   LEU     2       8.188   5.259  -0.000  1.00  0.00\nATOM     35  O   LEU     2       7.425   6.222   0.000  1.00  0.00\nATOM     36  N   TYR     3       9.517   5.386  -0.000  1.00  0.00\nATOM     37  H   TYR     3      10.103   4.564  -0.000  1.00  0.00\nATOM     38  CA  TYR     3      10.161   6.684   0.000  1.00  0.00\nATOM     39  HA  TYR     3       9.863   7.239  -0.890  1.00  0.00\nATOM     40  CB  TYR     3       9.768   7.492   1.232  1.00  0.00\nATOM     41  HB2 TYR     3       8.688   7.640   1.241  1.00  0.00\nATOM     42  HB3 TYR     3      10.068   6.954   2.131  1.00  0.00\nATOM     43  CG  TYR     3      10.458   8.835   1.195  1.00  0.00\nATOM     44  CD1 TYR     3      10.251   9.757   2.227  1.00  0.00\nATOM     45  HD1 TYR     3       9.591   9.507   3.058  1.00  0.00\nATOM     46  CE1 TYR     3      10.891  11.002   2.193  1.00  0.00\nATOM     47  HE1 TYR     3      10.730  11.720   2.997  1.00  0.00\nATOM     48  CZ  TYR     3      11.738  11.324   1.126  1.00  0.00\nATOM     49  OH  TYR     3      12.360  12.533   1.092  1.00  0.00\nATOM     50  HH  TYR     3      12.147  13.086   1.848  1.00  0.00\nATOM     51  CE2 TYR     3      11.946  10.401   0.094  1.00  0.00\nATOM     52  HE2 TYR     3      12.606  10.652  -0.737  1.00  0.00\nATOM     53  CD2 TYR     3      11.306   9.157   0.128  1.00  0.00\nATOM     54  HD2 TYR     3      11.467   8.439  -0.676  1.00  0.00\nATOM     55  C   TYR     3      11.677   6.544  -0.000  1.00  0.00\nATOM     56  O   TYR     3      12.200   5.432  -0.000  1.00  0.00\nATOM     57  N   ILE     4      12.382   7.677  -0.000  1.00  0.00\nATOM     58  H   ILE     4      11.906   8.568   0.000  1.00  0.00\nATOM     59  CA  ILE     4      13.831   7.677  -0.000  1.00  0.00\nATOM     60  HA  ILE     4      14.195   7.163   0.890  1.00  0.00\nATOM     61  CB  ILE     4      14.339   6.958  -1.245  1.00  0.00\nATOM     62  HB  ILE     4      13.976   5.931  -1.246  1.00  0.00\nATOM     63  CG2 ILE     4      13.831   7.677  -2.490  1.00  0.00\nATOM     64 HG21 ILE     4      14.194   8.705  -2.491  1.00  0.00\nATOM     65 HG22 ILE     4      14.194   7.164  -3.381  1.00  0.00\nATOM     66 HG23 ILE     4      12.741   7.677  -2.491  1.00  0.00\nATOM     67  CG1 ILE     4      15.864   6.958  -1.245  1.00  0.00\nATOM     68 HG12 ILE     4      16.228   7.986  -1.245  1.00  0.00\nATOM     69 HG13 ILE     4      16.228   6.445  -0.355  1.00  0.00\nATOM     70  CD1 ILE     4      16.373   6.239  -2.490  1.00  0.00\nATOM     71 HD11 ILE     4      16.010   6.753  -3.381  1.00  0.00\nATOM     72 HD12 ILE     4      17.463   6.239  -2.491  1.00  0.00\nATOM     73 HD13 ILE     4      16.010   5.212  -2.491  1.00  0.00\nATOM     74  C   ILE     4      14.379   9.097  -0.000  1.00  0.00\nATOM     75  O   ILE     4      13.616  10.060   0.000  1.00  0.00\nATOM     76  N   GLN     5      15.708   9.225  -0.000  1.00  0.00\nATOM     77  H   GLN     5      16.294   8.403  -0.000  1.00  0.00\nATOM     78  CA  GLN     5      16.352  10.523   0.000  1.00  0.00\nATOM     79  HA  GLN     5      16.054  11.077  -0.890  1.00  0.00\nATOM     80  CB  GLN     5      15.959  11.331   1.232  1.00  0.00\nATOM     81  HB2 GLN     5      14.879  11.478   1.241  1.00  0.00\nATOM     82  HB3 GLN     5      16.260  10.793   2.131  1.00  0.00\nATOM     83  CG  GLN     5      16.656  12.687   1.195  1.00  0.00\nATOM     84  HG2 GLN     5      17.736  12.540   1.186  1.00  0.00\nATOM     85  HG3 GLN     5      16.356  13.226   0.296  1.00  0.00\nATOM     86  CD  GLN     5      16.289  13.526   2.410  1.00  0.00\nATOM     87  OE1 GLN     5      15.521  13.086   3.263  1.00  0.00\nATOM     88  NE2 GLN     5      16.841  14.739   2.488  1.00  0.00\nATOM     89 HE21 GLN     5      16.630  15.336   3.275  1.00  0.00\nATOM     90 HE22 GLN     5      17.466  15.053   1.760  1.00  0.00\nATOM     91  C   GLN     5      17.868  10.382  -0.000  1.00  0.00\nATOM     92  O   GLN     5      18.391   9.270  -0.000  1.00  0.00\nATOM     93  N   TRP     6      18.573  11.516  -0.000  1.00  0.00\nATOM     94  H   TRP     6      18.097  12.407   0.000  1.00  0.00\nATOM     95  CA  TRP     6      20.022  11.516  -0.000  1.00  0.00\nATOM     96  HA  TRP     6      20.386  11.002   0.890  1.00  0.00\nATOM     97  CB  TRP     6      20.571  10.804  -1.232  1.00  0.00\nATOM     98  HB2 TRP     6      20.223   9.772  -1.241  1.00  0.00\nATOM     99  HB3 TRP     6      20.223  11.313  -2.131  1.00  0.00\nATOM    100  CG  TRP     6      22.078  10.753  -1.321  1.00  0.00\nATOM    101  CD1 TRP     6      22.809  10.192  -2.293  1.00  0.00\nATOM    102  HD1 TRP     6      22.316   9.706  -3.135  1.00  0.00\nATOM    103  NE1 TRP     6      24.183  10.390  -1.950  1.00  0.00\nATOM    104  HE1 TRP     6      24.975  10.076  -2.493  1.00  0.00\nATOM    105  CE2 TRP     6      24.249  11.044  -0.817  1.00  0.00\nATOM    106  CZ2 TRP     6      25.395  11.447  -0.120  1.00  0.00\nATOM    107  HZ2 TRP     6      26.384  11.217  -0.517  1.00  0.00\nATOM    108  CH2 TRP     6      25.175  12.133   1.069  1.00  0.00\nATOM    109  HH2 TRP     6      26.021  12.477   1.664  1.00  0.00\nATOM    110  CZ3 TRP     6      23.922  12.385   1.505  1.00  0.00\nATOM    111  HZ3 TRP     6      23.769  12.924   2.440  1.00  0.00\nATOM    112  CE3 TRP     6      22.783  11.969   0.786  1.00  0.00\nATOM    113  HE3 TRP     6      21.787  12.190   1.168  1.00  0.00\nATOM    114  CD2 TRP     6      23.005  11.278  -0.412  1.00  0.00\nATOM    115  C   TRP     6      20.570  12.936  -0.000  1.00  0.00\nATOM    116  O   TRP     6      19.807  13.899   0.000  1.00  0.00\nATOM    117  N   LEU     7      21.899  13.064  -0.000  1.00  0.00\nATOM    118  H   LEU     7      22.485  12.241  -0.000  1.00  0.00\nATOM    119  CA  LEU     7      22.543  14.362   0.000  1.00  0.00\nATOM    120  HA  LEU     7      22.245  14.916  -0.890  1.00  0.00\nATOM    121  CB  LEU     7      22.150  15.170   1.232  1.00  0.00\nATOM    122  HB2 LEU     7      21.070  15.317   1.241  1.00  0.00\nATOM    123  HB3 LEU     7      22.451  14.632   2.131  1.00  0.00\nATOM    124  CG  LEU     7      22.847  16.525   1.195  1.00  0.00\nATOM    125  HG  LEU     7      23.927  16.379   1.186  1.00  0.00\nATOM    126  CD1 LEU     7      22.426  17.279  -0.063  1.00  0.00\nATOM    127 HD11 LEU     7      21.346  17.426  -0.055  1.00  0.00\nATOM    128 HD12 LEU     7      22.925  18.248  -0.090  1.00  0.00\nATOM    129 HD13 LEU     7      22.707  16.701  -0.944  1.00  0.00\nATOM    130  CD2 LEU     7      22.454  17.333   2.427  1.00  0.00\nATOM    131 HD21 LEU     7      22.755  16.795   3.326  1.00  0.00\nATOM    132 HD22 LEU     7      22.952  18.303   2.400  1.00  0.00\nATOM    133 HD23 LEU     7      21.374  17.481   2.436  1.00  0.00\nATOM    134  C   LEU     7      24.059  14.221  -0.000  1.00  0.00\nATOM    135  O   LEU     7      24.582  13.109  -0.000  1.00  0.00\nATOM    136  N   LYS     8      24.764  15.354  -0.000  1.00  0.00\nATOM    137  H   LYS     8      24.288  16.245   0.000  1.00  0.00\nATOM    138  CA  LYS     8      26.213  15.354  -0.000  1.00  0.00\nATOM    139  HA  LYS     8      26.577  14.841   0.890  1.00  0.00\nATOM    140  CB  LYS     8      26.762  14.643  -1.232  1.00  0.00\nATOM    141  HB2 LYS     8      26.414  13.610  -1.241  1.00  0.00\nATOM    142  HB3 LYS     8      26.414  15.151  -2.131  1.00  0.00\nATOM    143  CG  LYS     8      28.286  14.665  -1.195  1.00  0.00\nATOM    144  HG2 LYS     8      28.635  15.697  -1.186  1.00  0.00\nATOM    145  HG3 LYS     8      28.635  14.156  -0.296  1.00  0.00\nATOM    146  CD  LYS     8      28.835  13.953  -2.427  1.00  0.00\nATOM    147  HD2 LYS     8      28.487  12.920  -2.436  1.00  0.00\nATOM    148  HD3 LYS     8      28.487  14.462  -3.326  1.00  0.00\nATOM    149  CE  LYS     8      30.360  13.975  -2.389  1.00  0.00\nATOM    150  HE2 LYS     8      30.709  15.008  -2.380  1.00  0.00\nATOM    151  HE3 LYS     8      30.709  13.466  -1.491  1.00  0.00\nATOM    152  NZ  LYS     8      30.889  13.289  -3.577  1.00  0.00\nATOM    153  HZ1 LYS     8      30.566  13.761  -4.410  1.00  0.00\nATOM    154  HZ2 LYS     8      31.899  13.304  -3.552  1.00  0.00\nATOM    155  HZ3 LYS     8      30.566  12.332  -3.585  1.00  0.00\nATOM    156  C   LYS     8      26.761  16.774   0.000  1.00  0.00\nATOM    157  O   LYS     8      25.998  17.737   0.000  1.00  0.00\nATOM    158  N   ASP     9      28.090  16.902  -0.000  1.00  0.00\nATOM    159  H   ASP     9      28.676  16.080  -0.000  1.00  0.00\nATOM    160  CA  ASP     9      28.734  18.200   0.000  1.00  0.00\nATOM    161  HA  ASP     9      28.436  18.754  -0.890  1.00  0.00\nATOM    162  CB  ASP     9      28.341  19.008   1.232  1.00  0.00\nATOM    163  HB2 ASP     9      27.261  19.155   1.241  1.00  0.00\nATOM    164  HB3 ASP     9      28.642  18.470   2.131  1.00  0.00\nATOM    165  CG  ASP     9      29.039  20.366   1.195  1.00  0.00\nATOM    166  OD1 ASP     9      28.433  21.309   0.620  1.00  0.00\nATOM    167  OD2 ASP     9      30.172  20.446   1.741  1.00  0.00\nATOM    168  C   ASP     9      30.250  18.060  -0.000  1.00  0.00\nATOM    169  O   ASP     9      30.773  16.948  -0.000  1.00  0.00\nATOM    170  N   GLY    10      30.955  19.193  -0.000  1.00  0.00\nATOM    171  H   GLY    10      30.479  20.084   0.000  1.00  0.00\nATOM    172  CA  GLY    10      32.404  19.193  -0.000  1.00  0.00\nATOM    173  HA2 GLY    10      32.768  18.679   0.890  1.00  0.00\nATOM    174  HA3 GLY    10      32.768  18.679  -0.890  1.00  0.00\nATOM    175  C   GLY    10      32.935  20.619   0.000  1.00  0.00\nATOM    176  O   GLY    10      32.159  21.573   0.000  1.00  0.00\nATOM    177  N   GLY    11      34.262  20.764  -0.000  1.00  0.00\nATOM    178  H   GLY    11      34.858  19.949  -0.000  1.00  0.00\nATOM    179  CA  GLY    11      34.890  22.069   0.000  1.00  0.00\nATOM    180  HA2 GLY    11      34.585  22.620  -0.890  1.00  0.00\nATOM    181  HA3 GLY    11      34.585  22.620   0.890  1.00  0.00\nATOM    182  C   GLY    11      36.406  21.929  -0.000  1.00  0.00\nATOM    183  O   GLY    11      36.929  20.817  -0.000  1.00  0.00\nATOM    184  N   PRO    12      37.111  23.062  -0.000  1.00  0.00\nATOM    185  CD  PRO    12      36.467  24.370   0.000  1.00  0.00\nATOM    186  HD2 PRO    12      36.160  24.625   1.014  1.00  0.00\nATOM    187  HD3 PRO    12      35.592  24.345  -0.649  1.00  0.00\nATOM    188  CG  PRO    12      37.540  25.280  -0.522  1.00  0.00\nATOM    189  HG2 PRO    12      37.496  26.226   0.016  1.00  0.00\nATOM    190  HG3 PRO    12      37.390  25.460  -1.586  1.00  0.00\nATOM    191  CB  PRO    12      38.847  24.566  -0.276  1.00  0.00\nATOM    192  HB2 PRO    12      39.344  25.013   0.586  1.00  0.00\nATOM    193  HB3 PRO    12      39.484  24.668  -1.155  1.00  0.00\nATOM    194  CA  PRO    12      38.562  23.062  -0.000  1.00  0.00\nATOM    195  HA  PRO    12      38.960  22.567  -0.886  1.00  0.00\nATOM    196  C   PRO    12      39.109  22.384   1.248  1.00  0.00\nATOM    197  O   PRO    12      38.346  21.870   2.064  1.00  0.00\nATOM    198  N   SER    13      40.435  22.384   1.396  1.00  0.00\nATOM    199  H   SER    13      41.021  22.820   0.698  1.00  0.00\nATOM    200  CA  SER    13      41.078  21.772   2.541  1.00  0.00\nATOM    201  HA  SER    13      40.731  22.254   3.455  1.00  0.00\nATOM    202  CB  SER    13      40.753  20.284   2.622  1.00  0.00\nATOM    203  HB2 SER    13      39.676  20.151   2.716  1.00  0.00\nATOM    204  HB3 SER    13      41.103  19.785   1.718  1.00  0.00\nATOM    205  OG  SER    13      41.404  19.715   3.762  1.00  0.00\nATOM    206  HG  SER    13      41.199  18.779   3.813  1.00  0.00\nATOM    207  C   SER    13      42.591  21.914   2.461  1.00  0.00\nATOM    208  O   SER    13      43.114  22.490   1.510  1.00  0.00\nATOM    209  N   SER    14      43.295  21.386   3.465  1.00  0.00\nATOM    210  H   SER    14      42.820  20.921   4.226  1.00  0.00\nATOM    211  CA  SER    14      44.742  21.455   3.505  1.00  0.00\nATOM    212  HA  SER    14      45.155  20.955   2.629  1.00  0.00\nATOM    213  CB  SER    14      45.223  22.902   3.512  1.00  0.00\nATOM    214  HB2 SER    14      44.875  23.405   2.610  1.00  0.00\nATOM    215  HB3 SER    14      44.825  23.413   4.389  1.00  0.00\nATOM    216  OG  SER    14      46.652  22.930   3.552  1.00  0.00\nATOM    217  HG  SER    14      46.954  23.841   3.557  1.00  0.00\nATOM    218  C   SER    14      45.289  20.777   4.753  1.00  0.00\nATOM    219  O   SER    14      44.526  20.263   5.569  1.00  0.00\nATOM    220  N   GLY    15      46.616  20.777   4.901  1.00  0.00\nATOM    221  H   GLY    15      47.201  21.213   4.203  1.00  0.00\nATOM    222  CA  GLY    15      47.258  20.164   6.046  1.00  0.00\nATOM    223  HA2 GLY    15      46.911  20.647   6.960  1.00  0.00\nATOM    224  HA3 GLY    15      47.009  19.104   6.079  1.00  0.00\nATOM    225  C   GLY    15      48.770  20.316   5.950  1.00  0.00\nATOM    226  O   GLY    15      49.279  20.894   4.993  1.00  0.00\nATOM    227  N   ARG    16      49.488  19.792   6.947  1.00  0.00\nATOM    228  H   ARG    16      49.023  19.326   7.713  1.00  0.00\nATOM    229  CA  ARG    16      50.934  19.870   6.972  1.00  0.00\nATOM    230  HA  ARG    16      51.341  19.373   6.091  1.00  0.00\nATOM    231  CB  ARG    16      51.406  21.321   6.973  1.00  0.00\nATOM    232  HB2 ARG    16      51.045  21.821   6.074  1.00  0.00\nATOM    233  HB3 ARG    16      51.015  21.830   7.853  1.00  0.00\nATOM    234  CG  ARG    16      52.930  21.359   6.999  1.00  0.00\nATOM    235  HG2 ARG    16      53.291  20.859   7.898  1.00  0.00\nATOM    236  HG3 ARG    16      53.322  20.851   6.118  1.00  0.00\nATOM    237  CD  ARG    16      53.402  22.809   7.000  1.00  0.00\nATOM    238  HD2 ARG    16      53.041  23.310   6.102  1.00  0.00\nATOM    239  HD3 ARG    16      53.011  23.319   7.881  1.00  0.00\nATOM    240  NE  ARG    16      54.880  22.886   7.025  1.00  0.00\nATOM    241  HE  ARG    16      55.407  22.025   7.039  1.00  0.00\nATOM    242  CZ  ARG    16      55.545  24.038   7.031  1.00  0.00\nATOM    243  NH1 ARG    16      54.921  25.213   7.015  1.00  0.00\nATOM    244 HH11 ARG    16      53.912  25.245   6.997  1.00  0.00\nATOM    245 HH12 ARG    16      55.460  26.067   7.020  1.00  0.00\nATOM    246  NH2 ARG    16      56.874  23.991   7.055  1.00  0.00\nATOM    247 HH21 ARG    16      57.345  23.098   7.067  1.00  0.00\nATOM    248 HH22 ARG    16      57.406  24.850   7.060  1.00  0.00\nATOM    249  C   ARG    16      51.498  19.197   8.214  1.00  0.00\nATOM    250  O   ARG    16      50.747  18.679   9.038  1.00  0.00\nATOM    251  N   PRO    17      52.826  19.205   8.348  1.00  0.00\nATOM    252  CD  PRO    17      53.697  19.826   7.357  1.00  0.00\nATOM    253  HD2 PRO    17      53.727  20.903   7.523  1.00  0.00\nATOM    254  HD3 PRO    17      53.312  19.624   6.358  1.00  0.00\nATOM    255  CG  PRO    17      55.022  19.167   7.604  1.00  0.00\nATOM    256  HG2 PRO    17      55.813  19.907   7.485  1.00  0.00\nATOM    257  HG3 PRO    17      55.173  18.356   6.892  1.00  0.00\nATOM    258  CB  PRO    17      54.967  18.641   9.018  1.00  0.00\nATOM    259  HB2 PRO    17      55.543  19.299   9.669  1.00  0.00\nATOM    260  HB3 PRO    17      55.396  17.639   9.045  1.00  0.00\nATOM    261  CA  PRO    17      53.486  18.596   9.488  1.00  0.00\nATOM    262  HA  PRO    17      53.275  17.528   9.547  1.00  0.00\nATOM    263  C   PRO    17      53.063  19.268  10.787  1.00  0.00\nATOM    264  O   PRO    17      52.214  20.157  10.782  1.00  0.00\nATOM    265  N   PRO    18      53.658  18.839  11.903  1.00  0.00\nATOM    266  CD  PRO    18      54.662  17.782  11.884  1.00  0.00\nATOM    267  HD2 PRO    18      55.626  18.202  11.595  1.00  0.00\nATOM    268  HD3 PRO    18      54.370  17.016  11.166  1.00  0.00\nATOM    269  CG  PRO    18      54.654  17.276  13.296  1.00  0.00\nATOM    270  HG2 PRO    18      55.676  17.043  13.595  1.00  0.00\nATOM    271  HG3 PRO    18      54.041  16.378  13.366  1.00  0.00\nATOM    272  CB  PRO    18      54.074  18.391  14.134  1.00  0.00\nATOM    273  HB2 PRO    18      54.880  18.896  14.666  1.00  0.00\nATOM    274  HB3 PRO    18      53.372  17.970  14.854  1.00  0.00\nATOM    275  CA  PRO    18      53.342  19.399  13.204  1.00  0.00\nATOM    276  HA  PRO    18      52.291  19.252  13.456  1.00  0.00\nATOM    277  C   PRO    18      53.672  20.884  13.255  1.00  0.00\nATOM    278  O   PRO    18      54.085  21.466  12.254  1.00  0.00\nATOM    279  N   PRO    19      53.489  21.497  14.427  1.00  0.00\nATOM    280  CD  PRO    19      52.998  20.785  15.600  1.00  0.00\nATOM    281  HD2 PRO    19      53.822  20.247  16.071  1.00  0.00\nATOM    282  HD3 PRO    19      52.227  20.075  15.300  1.00  0.00\nATOM    283  CG  PRO    19      52.458  21.884  16.467  1.00  0.00\nATOM    284  HG2 PRO    19      52.690  21.662  17.508  1.00  0.00\nATOM    285  HG3 PRO    19      51.378  21.958  16.344  1.00  0.00\nATOM    286  CB  PRO    19      53.141  23.150  16.007  1.00  0.00\nATOM    287  HB2 PRO    19      53.921  23.416  16.721  1.00  0.00\nATOM    288  HB3 PRO    19      52.408  23.954  15.954  1.00  0.00\nATOM    289  CA  PRO    19      53.768  22.910  14.604  1.00  0.00\nATOM    290  HA  PRO    19      53.150  23.523  13.948  1.00  0.00\nATOM    291  C   PRO    19      55.237  23.214  14.348  1.00  0.00\nATOM    292  O   PRO    19      56.002  22.327  13.975  1.00  0.00\nATOM    293  N   SER    20      55.631  24.473  14.549  1.00  0.00\nATOM    294  H   SER    20      54.965  25.168  14.856  1.00  0.00\nATOM    295  CA  SER    20      57.003  24.889  14.340  1.00  0.00\nATOM    296  HA  SER    20      57.660  24.320  14.998  1.00  0.00\nATOM    297  CB  SER    20      57.434  24.652  12.897  1.00  0.00\nATOM    298  HB2 SER    20      57.352  23.591  12.662  1.00  0.00\nATOM    299  HB3 SER    20      56.791  25.223  12.226  1.00  0.00\nATOM    300  OG  SER    20      58.790  25.074  12.729  1.00  0.00\nATOM    301  HG  SER    20      59.062  24.925  11.821  1.00  0.00\nATOM    302  C   SER    20      57.178  26.371  14.641  1.00  0.00\nATOM    303  O   SER    20      56.222  27.050  15.008  1.00  0.00\nATOM    304  OXT SER    20      58.278  26.906  14.519  1.00  0.00\nTER   \nEND   \n");
	viewer_1651750336480033.setStyle({"model": -1},{"stick": {"color": "spectrum"}});
	viewer_1651750336480033.zoomTo();
viewer_1651750336480033.render();
});
</script></div></div>
</div>
<div class="exercise admonition" id="ex5">
<p class="admonition-title">Exercise 5</p>
<p>Include an image of the starting structure in your report. Are there any residues which  would contribute to the instability of the starting structure in its current conformation, why?</p>
</div>
</section>
</section>
<section id="simulating-the-system">
<h2><span class="section-number">6.3.3. </span>Simulating the system<a class="headerlink" href="#simulating-the-system" title="Permalink to this headline">#</a></h2>
<p>Now we can start the simulation by writing our simulation script in python.</p>
<p>First, lets import the required modules:</p>
<ul class="simple">
<li><p>openmm for running the simulation</p></li>
<li><p>parmed to read/write the input and output files</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># OpenMM Imports</span>
<span class="kn">import</span> <span class="nn">simtk.openmm</span> <span class="k">as</span> <span class="nn">mm</span>
<span class="kn">import</span> <span class="nn">simtk.openmm.app</span> <span class="k">as</span> <span class="nn">app</span>
<span class="kn">from</span> <span class="nn">simtk.openmm.app.dcdreporter</span> <span class="kn">import</span> <span class="n">DCDReporter</span>
<span class="c1"># ParmEd Imports</span>
<span class="kn">from</span> <span class="nn">parmed</span> <span class="kn">import</span> <span class="n">load_file</span><span class="p">,</span> <span class="n">unit</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">parmed.openmm</span> <span class="kn">import</span> <span class="n">StateDataReporter</span>

<span class="c1"># System modules</span>
<span class="kn">import</span> <span class="nn">sys</span>
</pre></div>
</div>
</div>
</div>
<section id="loading-amber-files">
<h3><span class="section-number">6.3.3.1. </span>Loading Amber files<a class="headerlink" href="#loading-amber-files" title="Permalink to this headline">#</a></h3>
<p>In this stage, we simply instantiate the AmberParm object from the input topology and coordinate files. After this command, <code class="docutils literal notranslate"><span class="pre">trp_cage_gas</span></code> will contain a full description of every particle, the parameters defining their interactions, and their position.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the Amber files</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Loading AMBER files...&#39;</span><span class="p">)</span>
<span class="n">trp_cage_gas</span> <span class="o">=</span> <span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;trp_cage.prmtop&#39;</span><span class="p">,</span> <span class="s1">&#39;trp_cage_linear.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading AMBER files...
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-the-openmm-system">
<h3><span class="section-number">6.3.3.2. </span>Create the OpenMM System<a class="headerlink" href="#create-the-openmm-system" title="Permalink to this headline">#</a></h3>
<p>This command creates an OpenMM <code class="docutils literal notranslate"><span class="pre">System</span></code> object from the information stored in
<code class="docutils literal notranslate"><span class="pre">trp_cage_gas</span></code>. It contains multiple <code class="docutils literal notranslate"><span class="pre">Force</span></code> instances for the bonds, angles,
periodic torsions, and nonbonded (electrostatic and van der Waals) interactions.
It is in this function that we define the potential parameters we want to use.
In this example, we have chosen the default values for each parameter except the
ones specified. In particular:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nonbondedMethod=app.NoCutoff</span></code> indicates we do not want to use a cutoff for nonbonded interactions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">constraints=app.HBonds</span></code> indicates we want to constrain all bonds in which at least one atom is a Hydrogen (i.e., SHAKE or SETTLE for water).  Other options are <code class="docutils literal notranslate"><span class="pre">None</span></code> (no constraints), <code class="docutils literal notranslate"><span class="pre">app.AllBonds</span></code>, or <code class="docutils literal notranslate"><span class="pre">app.HAngles</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">implicitSolvent=app.GBn2</span></code> indicates we want to use the second GBneck model described in Nguyen et al., J. Chem. Theory Comput., 2014 9(4) p.2020-2034.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">implicitSolventSaltConc=0.1*u.liters/u.mole</span></code> indicates we want to model a ca. 0.1 molar solution of monovalent ions using a Debye screening model.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the OpenMM system</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Creating OpenMM System&#39;</span><span class="p">)</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">trp_cage_gas</span><span class="o">.</span><span class="n">createSystem</span><span class="p">(</span><span class="n">nonbondedMethod</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">NoCutoff</span><span class="p">,</span>
                               <span class="n">constraints</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">HBonds</span><span class="p">,</span> <span class="n">implicitSolvent</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">GBn2</span><span class="p">,</span>
                               <span class="n">implicitSolventSaltConc</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">moles</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">liter</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Creating OpenMM System
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-the-integrator-to-do-langevin-dynamics">
<h3><span class="section-number">6.3.3.3. </span>Create the integrator to do Langevin Dynamics<a class="headerlink" href="#create-the-integrator-to-do-langevin-dynamics" title="Permalink to this headline">#</a></h3>
<p>In this stage we specify an integrator. Common choices are
<code class="docutils literal notranslate"><span class="pre">LangevinIntegrator</span></code> (as we’ve chosen here) to do simulations in the NVT
ensemble.  In this
example, we’ve chosen the Langevin integrator with a target temperature of
300 K, a friction coefficient of 1/ps and a time step of 0.5 fs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the integrator to do Langevin dynamics</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">LangevinIntegrator</span><span class="p">(</span>
                        <span class="mi">0</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kelvin</span><span class="p">,</span>       <span class="c1"># Temperature of heat bath</span>
                        <span class="mf">1.0</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">picoseconds</span><span class="p">,</span>  <span class="c1"># Friction coefficient</span>
                        <span class="mf">0.5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">femtoseconds</span><span class="p">,</span> <span class="c1"># Time step</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-the-simulation-object">
<h3><span class="section-number">6.3.3.4. </span>Create the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> object<a class="headerlink" href="#create-the-simulation-object" title="Permalink to this headline">#</a></h3>
<p>This step creates a <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> object that will be used to run the actual
simulations.  OpenMM picks the fastest platform for us
if we do not specify a platform.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the Simulation object</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">trp_cage_gas</span><span class="o">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">integrator</span><span class="p">,)</span>
</pre></div>
</div>
</div>
</div>
<p>This stage is very important.  In this step, we set the particle positions
stored in the <code class="docutils literal notranslate"><span class="pre">trp_cage_gas</span></code> object to our object. If you omit this step, you can
get strange results or other errors like segmentation violations. These particle
positions have been parsed from the input coordinate file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the particle positions</span>
<span class="n">sim</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">setPositions</span><span class="p">(</span><span class="n">trp_cage_gas</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="minimize-the-energy">
<h3><span class="section-number">6.3.3.5. </span>Minimize the energy<a class="headerlink" href="#minimize-the-energy" title="Permalink to this headline">#</a></h3>
<p>This stage performs a basic energy minimization to relax particle positions.
This particular invocation will perform at most 500 iterations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Minimize the energy</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Minimizing energy&#39;</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">minimizeEnergy</span><span class="p">(</span><span class="n">maxIterations</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">state</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="n">getEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">getPotentialEnergy</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="heating-phase">
<h3><span class="section-number">6.3.3.6. </span>Heating phase<a class="headerlink" href="#heating-phase" title="Permalink to this headline">#</a></h3>
<p>After having obtained the minimized coordinates of our system we can begin slowly heating it.
We define reporters that will “report” on the status of the simulation
periodically throughout the heating phase. The first is a <code class="docutils literal notranslate"><span class="pre">StateDataReporter</span></code>
which will print out a summary of energies and temperatures every 500 steps.
This reporter directs the printout to standard output (the screen), <code class="docutils literal notranslate"><span class="pre">sys.stdout</span></code> or to a file name (if set).</p>
<p>The second reporter is a NetCDF trajectory reporter, which is written in the
Amber NetCDF format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Heating phase&#39;</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">reporters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateDataReporter</span><span class="p">(</span><span class="s1">&#39;heating.csv&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">potentialEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">kineticEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
 <span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">reporters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
         <span class="n">DCDReporter</span><span class="p">(</span><span class="s1">&#39;trp_cage_heating.dcd&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">integrator</span><span class="o">.</span><span class="n">setTemperature</span><span class="p">(</span><span class="mi">65</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kelvin</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>  <span class="c1">## Change this in order to run 50 ps of heating in 5 steps</span>

<span class="n">state</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="n">getPositions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">minimized_and_heated</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">getPositions</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;heating.csv&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time (ps)&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Potential Energy (kilocalorie/mole)&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Epot&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time (ps)&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Kinetic Energy (kilocalorie/mole)&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ekin&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time (ps)&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Total Energy (kilocalorie/mole)&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Etot&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (ps)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy (kcal/mol)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time (ps)&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (ps)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temp (K)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="running-dynamics">
<h2><span class="section-number">6.3.4. </span>Running dynamics<a class="headerlink" href="#running-dynamics" title="Permalink to this headline">#</a></h2>
<p>We first reset our Integrator to update the timestep, create the simulation object and then we actually run the MD of our heated system to see if our linear peptide folds up into its 3D form. We use again the <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code> and <code class="docutils literal notranslate"><span class="pre">StateDataReporter</span></code> to retrieve information about our simulation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the integrator to do Langevin dynamics</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">LangevinIntegrator</span><span class="p">(</span>
                        <span class="mi">325</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kelvin</span><span class="p">,</span>       <span class="c1"># Temperature of heat bath</span>
                        <span class="mf">1.0</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">picoseconds</span><span class="p">,</span>  <span class="c1"># Friction coefficient</span>
                        <span class="mf">2.0</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">femtoseconds</span><span class="p">,</span> <span class="c1"># Time step</span>
<span class="p">)</span>

<span class="c1"># Create the Simulation object</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">trp_cage_gas</span><span class="o">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>

<span class="c1"># Set the particle positions</span>
<span class="n">sim</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">setPositions</span><span class="p">(</span><span class="n">minimized_and_heated</span><span class="p">)</span>

<span class="c1"># Set up the reporters to report energies and coordinates every 50000 steps</span>
<span class="n">sim</span><span class="o">.</span><span class="n">reporters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">StateDataReporter</span><span class="p">(</span><span class="s1">&#39;production.csv&#39;</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">potentialEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">kineticEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="c1"># Additionally print to the output of the notebook, so that we can track the simulation.</span>
<span class="n">sim</span><span class="o">.</span><span class="n">reporters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">StateDataReporter</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">potentialEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">kineticEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">reporters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">DCDReporter</span><span class="p">(</span><span class="s1">&#39;trp_cage_gb.dcd&#39;</span><span class="p">,</span> <span class="mi">50000</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Run dynamics</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running dynamics&#39;</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># change this to run 20 ns of simulation</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting energy from production simulation</span>

<span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;production.csv&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time (ps)&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Potential Energy (kilocalorie/mole)&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Epot&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time (ps)&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Kinetic Energy (kilocalorie/mole)&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ekin&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time (ps)&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Total Energy (kilocalorie/mole)&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Etot&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (ps)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy (kcal/mol)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average temperature&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> +- </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time (ps)&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (ps)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temp (K)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="save-trajectory-for-later-processing">
<h2><span class="section-number">6.3.5. </span>Save trajectory for later processing<a class="headerlink" href="#save-trajectory-for-later-processing" title="Permalink to this headline">#</a></h2>
<p>Now we zip the files and upload the files to a filesharing provider to download them again on noto.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>zip<span class="w"> </span>archive.zip<span class="w"> </span>trp_cage*<span class="w"> </span>production.csv<span class="w"> </span>heating.csv
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>curl<span class="w"> </span>--upload-file<span class="w"> </span>archive.zip<span class="w"> </span>https://transfer.sh
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Ex6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="proteinmodelling.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">6.2. </span>Protein Modelling</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="hydrogenbonds.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.4. </span>TrpCage Analysis</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Simon Duerr, Sophie Johnson, Irea Mosquera, Andrea Levy,  Ursula Roethlisberger<br/>
  
    <div class="extra_footer">
      <div class="container-lg mt-3 footer"> <div class="row"> <div class="col-xl-9 d-flex"> <div class="container"> <div class="row"> <div class="col-6 d-flex" style="justify-content:center"> <a href="https://lcbc.epfl.ch"> Laboratory of Computational Biochemistry and Chemistry</a></li>
</div> <div class="col-6 d-flex" style="justify-content:center"> <ul style="list-style:none"> <li> <a href="https://github.com/lcbc-epfl/mdmc-public">GitHub </a> </li> </li> <!--<li> <a href="https://doi.org/10.5281/zenodo.0000000"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.00000000.svg" alt="DOI"></a> </li>--> </ul> </div> </div> </div> </div> <div class="col-xl-3"> <a href="https://epfl.ch"><img src="https://www.epfl.ch/wp/5.5/wp-content/themes/wp-theme-2018/assets/svg/epfl-logo.svg?refresh=now" alt="EPFL Logo" style="padding:5px;height:33px;"></a> </div> </div> </div> <div class="row_footer my-3"> Dual licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Commons Attribution Share Alike 4.0 International</a> (CC BY SA 4.0) and MIT license. (Except where indicated otherwise) </div>
    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>