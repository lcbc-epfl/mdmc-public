
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6.1. Theory &#8212; Molecular Dynamics and Monte Carlo</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"ket": ["\\lvert #1 \\rangle", 1], "bra": ["\\langle #1 \\lvert", 1], "Ket": ["\\lvert #1 \\rangle", 1], "Bra": ["\\langle #1 \\lvert", 1], "braket": ["\\langle #1 \\lvert #2 \\rangle", 2], "hop": "\\hat{\\mathcal{H}}", "unit": "\\mathbbm{1}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.2. Protein Modelling" href="proteinmodelling.html" />
    <link rel="prev" title="6. Properties from Molecular Dynamics" href="MDMC_ex6.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Molecular Dynamics and Monte Carlo</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Molecular Dynamics and Monte Carlo
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Exercises
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex1/MDMC_ex1.html">
   1. Basic Concepts of Molecular Dynamics and Monte Carlo Simulations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/Ex1_Theory.html">
     1.1. From Quantum to Classical Mechanics: The Example of Forces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/MonteCarloPI.html">
     1.3. Monte Carlo
     <span class="math notranslate nohighlight">
      \(\pi\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex1/prng.html">
     1.4. Appendix: Random and Pseudo-random Numbers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex2/MDMC_ex2.html">
   2. Statistical Thermodynamics and the Boltzmann Distribution
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex2/Ex2_Theory.html">
     2.1. Statistical Thermodynamics and the Boltzmann Distribution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex2/Boltzmann.html">
     2.2. Boltzmann Distribution Harmonic Oscillator
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex3/MDMC_ex3.html">
   3. Monte Carlo Simulations and the Photon Gas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/Ex3_Theory.html">
     3.1. Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/PhotonGas.html">
     3.2. The Photon Gas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex3/LJ_NVT.html">
     3.3. The Lennard-Jones Potential
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex4/MDMC_ex4.html">
   4. Introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/Theory.html">
     4.1. Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex4/Exercise.html">
     4.2. MD simulation from scratch
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Ex5/MDMC_ex5.html">
   5. Classical Molecular Dynamics (MD) Simulations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex5/theory.html">
     5.1. Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex5/Exercise.html">
     5.2. ToyMD
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="MDMC_ex6.html">
   6. Properties from Molecular Dynamics
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6.1. Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="proteinmodelling.html">
     6.2. Protein Modelling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="TRP_Cage_OpenMM_colab.html">
     6.3. Practical: TRP Cage using OpenMM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hydrogenbonds.html">
     6.4. TrpCage Analysis
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://noto.epfl.ch/hub/user-redirect/git-pull?repo=https%3A//github.com/lcbc-epfl/mdmc-public&urlpath=lab/tree/mdmc-public/mdmc/Ex6/theory.ipynb&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/lcbc-epfl/mdmc-public/blob/main/mdmc/Ex6/theory.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/lcbc-epfl/mdmc-public"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/lcbc-epfl/mdmc-public/issues/new?title=Issue%20on%20page%20%2FEx6/theory.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Ex6/theory.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solvent-models-in-molecular-dynamics">
   6.1.1. Solvent Models in Molecular Dynamics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#explicit-solvent">
     6.1.1.1. Explicit Solvent
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#implicit-solvent">
     6.1.1.2. Implicit Solvent
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sasa-solvent-accessible-surface-area-models">
       6.1.1.2.1. SASA: Solvent-accessible surface area models
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pb-poisson-boltzmann">
       6.1.1.2.2. PB: Poisson-Boltzmann
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#gb-the-generalised-born-equation">
       6.1.1.2.3. GB: The Generalised Born equation
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#properties-from-md">
   6.1.2. Properties from MD
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rmsd">
     6.1.2.1. RMSD
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pressure-and-the-virial-theorem">
     6.1.2.2. Pressure and the virial theorem
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Theory</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solvent-models-in-molecular-dynamics">
   6.1.1. Solvent Models in Molecular Dynamics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#explicit-solvent">
     6.1.1.1. Explicit Solvent
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#implicit-solvent">
     6.1.1.2. Implicit Solvent
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sasa-solvent-accessible-surface-area-models">
       6.1.1.2.1. SASA: Solvent-accessible surface area models
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pb-poisson-boltzmann">
       6.1.1.2.2. PB: Poisson-Boltzmann
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#gb-the-generalised-born-equation">
       6.1.1.2.3. GB: The Generalised Born equation
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#properties-from-md">
   6.1.2. Properties from MD
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rmsd">
     6.1.2.1. RMSD
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pressure-and-the-virial-theorem">
     6.1.2.2. Pressure and the virial theorem
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="theory">
<span id="id1"></span><h1><span class="section-number">6.1. </span>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">#</a></h1>
<section id="solvent-models-in-molecular-dynamics">
<h2><span class="section-number">6.1.1. </span>Solvent Models in Molecular Dynamics<a class="headerlink" href="#solvent-models-in-molecular-dynamics" title="Permalink to this headline">#</a></h2>
<p>The simulation of complex systems in their natural environment poses a
considerable challenge; the possibility of simulating a protein in a
cellular environment is not only constrained by the protein size itself,
but also by the large number of solvent molecules (water molecules,
ions) surrounding the biomolecular complex of interest. Since many of
the properties of any system in solution are governed by its
environment, the inclusion of solvation effects is a crucial ingredient
for any successful MD simulation (idem for MC).</p>
<section id="explicit-solvent">
<h3><span class="section-number">6.1.1.1. </span>Explicit Solvent<a class="headerlink" href="#explicit-solvent" title="Permalink to this headline">#</a></h3>
<p>The sheer number of water molecules surrounding a protein will
considerably increase the computational cost of a simulation, since the
simulation box has to be chosen reasonably big in order for the solvent
to properly mimick the properties of a bulk system and to prevent
interaction between the periodic images of the solute. Solvent molecules
have to be treated like the rest of the system (be it by a force field
or <em>first principles</em> methods), and are therefore referred to as an
<em>explicit solvent</em>.</p>
<p>The computational cost of using an explicit solvent can often be reduced
by choosing a suitable level of accuracy (<em>e.g.</em> in <em>ab initio</em> QM/MM
simulations, the chemically inert solvent molecules may be treated using
a force field). However, for larger systems that make exclusive use of
parametrised potentials, the number of molecules needed to solvate the
structure may easily overpass the number of atoms in the structure of
interest. This makes an explicit treatment prohibitively expensive due
to an exorbitantly high number of degrees of freedom that have to be
explicitly considered.</p>
<p>It is therefore often necessary to further simplify the description of
the system by using appropriate <em>implicit</em> solvent models instead of
explicit solvent.</p>
</section>
<section id="implicit-solvent">
<h3><span class="section-number">6.1.1.2. </span>Implicit Solvent<a class="headerlink" href="#implicit-solvent" title="Permalink to this headline">#</a></h3>
<p>Although an explicit description of solvent molecules is clearly
preferrable due to the natural inclusion of effects such as the
solvent’s response to polarisation, bridging and hydrogen-bonding, an
implicit mean-field contribution may already capture the most important
effects of the environment (such as changes in polarisability).
Formally, the solvent contribution to the Helmholtz (or Gibbs) free
energy (<span class="math notranslate nohighlight">\(F\)</span> and <span class="math notranslate nohighlight">\(G\)</span>, respectively) may be divided into different terms:</p>
<div class="math notranslate nohighlight" id="equation-free-energy-solvation">
<span class="eqno">(6.1)<a class="headerlink" href="#equation-free-energy-solvation" title="Permalink to this equation">#</a></span>\[
\begin{aligned}
\Delta F_\text{sol} = \Delta F_\text{cav} + \Delta F_\text{vdW} + \Delta F_\text{ele},
\end{aligned}
\]</div>
<p>where the energy is decomposed in components due to the formation of a
cavity in the solvent by the solute (<em>cav</em>) and the resulting van der
Waals (<em>vdW</em>) and electrostatic (<em>ele</em>) interactions. Different implicit
solvent models may account for different terms in eq. 1.
Solvent-accessible surface area models may take the entire
<span class="math notranslate nohighlight">\(\Delta F_\text{sol}\)</span> into account, the Poisson-Boltzmann and
Generalised-Born methods model solely <span class="math notranslate nohighlight">\(\Delta F_\text{ele}\)</span>.</p>
<section id="sasa-solvent-accessible-surface-area-models">
<h4><span class="section-number">6.1.1.2.1. </span>SASA: Solvent-accessible surface area models<a class="headerlink" href="#sasa-solvent-accessible-surface-area-models" title="Permalink to this headline">#</a></h4>
<p>SASA models assume the interactions between solute and solvent to be
proportional to the solute’s surface area. The free energy of solvation
is described by a mean solvent potential
<span class="math notranslate nohighlight">\(V_\text{solv}^\text{SASA}(\mathbf{r}_i)\)</span> that depends on the
atom-specific solvation energy per surface area <span class="math notranslate nohighlight">\(\sigma_i\)</span> and the
solvent-accessible surface area (SASA<span class="math notranslate nohighlight">\(_i\)</span>) for atom <span class="math notranslate nohighlight">\(i\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-sasa">
<span class="eqno">(6.2)<a class="headerlink" href="#equation-sasa" title="Permalink to this equation">#</a></span>\[
\begin{aligned}
V_\text{sol}^\text{SASA} = \sum_i \sigma_i \cdot \text{SASA}_i(\mathbf{r}_i).
\end{aligned}
\]</div>
<p>Various algorithms of different accuracy exist to calculate the SASA.</p>
</section>
<section id="pb-poisson-boltzmann">
<h4><span class="section-number">6.1.1.2.2. </span>PB: Poisson-Boltzmann<a class="headerlink" href="#pb-poisson-boltzmann" title="Permalink to this headline">#</a></h4>
<p>The Poisson equation relates the scalar electric potential
<span class="math notranslate nohighlight">\(\Phi(\mathbf{r})\)</span> to the charge density <span class="math notranslate nohighlight">\(\rho(\mathbf{r})\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eqpb1">
<span class="eqno">(6.3)<a class="headerlink" href="#equation-eqpb1" title="Permalink to this equation">#</a></span>\[
\begin{aligned}
\nabla \cdot \left[\epsilon(\mathbf{r})\nabla \Phi(\mathbf{r})  \right] = -\frac{\rho(\mathbf{r})}{\epsilon_0},
\end{aligned}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon(\mathbf{r})\)</span> is the local dielectric constant and
<span class="math notranslate nohighlight">\(\epsilon_0\)</span> the vacuum permitivity. The solution of Poisson’s equation
for the potential requires knowing the charge density distribution such
that</p>
<div class="math notranslate nohighlight" id="equation-charge-density-dist">
<span class="eqno">(6.4)<a class="headerlink" href="#equation-charge-density-dist" title="Permalink to this equation">#</a></span>\[
 \begin{aligned}
\Phi(\mathbf{r}) = \frac{1}{4\pi \epsilon_0 \epsilon(\mathbf{r})} \int \frac{\rho(\mathbf{r})}{\left|\mathbf{r}\right|} \mathrm{d}V(\mathbf{r}).
\end{aligned}
\]</div>
<p>In the case of an ionic solution (solvent), the electrostatic potential
resulting from a solvated charge density <span class="math notranslate nohighlight">\(\rho^{f}(\mathbf{r})\)</span> (solute)
should account for electrostatic forces between solute and solvent as
well as the ions thermal motion. Assuming ions as point charges, their
concentrations is expected to follow a Boltzmann distribution at thermal
equilibrium:</p>
<div class="math notranslate nohighlight" id="equation-conc">
<span class="eqno">(6.5)<a class="headerlink" href="#equation-conc" title="Permalink to this equation">#</a></span>\[
c_i(\mathbf{r}) = c_i^{\infty} \cdot \text{exp}\left(-\frac{U_i(\mathbf{r})}{k_B T}\right)
\]</div>
<p>where <span class="math notranslate nohighlight">\(c_i^{\infty}\)</span> represents the concentration of the ion <span class="math notranslate nohighlight">\(i\)</span>, of
electrostatic energy <span class="math notranslate nohighlight">\(U_i(\mathbf{r})\)</span>, at a distance of infinity from
the solute (bulk concentration). <span class="math notranslate nohighlight">\(k_B\)</span> is the Boltzmann constant and <span class="math notranslate nohighlight">\(T\)</span>
the temperature.</p>
<p>Considering <a class="reference internal" href="#equation-conc">(6.5)</a>
in <a class="reference internal" href="#equation-eqpb1">(6.3)</a>, one
obtains a special case of the Poisson equation, the <em>Poisson-Boltzmann</em>
(PB) equation. You will go through the derivation of the PB equation as
an exercise. The PB equation can further be linearized under the
assumption that the potential is small which yields:</p>
<div class="math notranslate nohighlight" id="equation-eqpb2">
<span class="eqno">(6.6)<a class="headerlink" href="#equation-eqpb2" title="Permalink to this equation">#</a></span>\[
\begin{aligned}
\nabla \cdot \left[\epsilon_0\epsilon(\mathbf{r})\nabla \Phi(\mathbf{r})  \right] + \rho_\text{ext}(\mathbf{r}) =  \left(\frac{q^2}{k_B T} \sum_i c_i^{\infty} z_i^2\right) \Phi(\mathbf{r})
\end{aligned}
\]</div>
<p>with <span class="math notranslate nohighlight">\(z_i\)</span> the valence of the ion, <span class="math notranslate nohighlight">\(q\)</span> is the charge of a proton and
<span class="math notranslate nohighlight">\(\rho_\text{ext}(\mathbf{r})\)</span> is an effective density from solute and
solvent.</p>
<div class="exercise admonition" id="bex1">
<p class="admonition-title">Bonus Exercise 1</p>
<p>Derive <a class="reference internal" href="#equation-eqpb2">(6.6)</a> from <a class="reference internal" href="#equation-eqpb1">(6.3)</a> by passing via the exponential form of the Poisson-Boltzmann equation <a class="reference internal" href="#equation-conc">(6.5)</a>.    Give an appropriate expression for the equilibrium charge density  <span class="math notranslate nohighlight">\(\rho_\text{ext}(\mathbf{r})\)</span> in the Poisson-Boltzmann approach.</p>
</div>
</section>
<section id="gb-the-generalised-born-equation">
<h4><span class="section-number">6.1.1.2.3. </span>GB: The Generalised Born equation<a class="headerlink" href="#gb-the-generalised-born-equation" title="Permalink to this headline">#</a></h4>
<p>Alternatively, the Poisson-Boltzmann equation may be solved for a charge
in the centre of an ideally spherical solute, yielding the Generalised
Born (GB) equation:</p>
<div class="math notranslate nohighlight" id="equation-gb">
<span class="eqno">(6.7)<a class="headerlink" href="#equation-gb" title="Permalink to this equation">#</a></span>\[
\begin{aligned}
\Delta F_\text{solv} = \frac{1}{2} \left( \frac{1}{\epsilon_\text{int}} -\frac{1}{\epsilon_\text{ext}} \right) \frac{q^2}{\alpha}.
\end{aligned}
\]</div>
<p>Here, <span class="math notranslate nohighlight">\(q\)</span> is the unit charge, the solute has radius <span class="math notranslate nohighlight">\(\alpha\)</span> and an
internal dielectric constant <span class="math notranslate nohighlight">\(\epsilon_\text{int}\)</span> and is embedded in a
solvent with a dielectric <span class="math notranslate nohighlight">\(\epsilon_\text{ext}\)</span>. The GB method emulates
a local pseudo-ideal solution within a non-ideal solute by varying
<span class="math notranslate nohighlight">\(\alpha\)</span>. This <em>effective Born radius</em> adjusts the local screening to
the best possible value with respect to some reference data. The
effective Born radii of all species are then used to compute GB pair
terms:</p>
<div class="math notranslate nohighlight" id="equation-gb-pair-terms">
<span class="eqno">(6.8)<a class="headerlink" href="#equation-gb-pair-terms" title="Permalink to this equation">#</a></span>\[
\begin{aligned}
\Delta F_\text{solv} = \frac{1}{2} \sum_{ij} \frac{\left( \frac{1}{\epsilon_\text{int}} -\frac{1}{\epsilon_\text{ext}} \right)
 q_i q_j}{\left(r_{ij}^2 +\alpha_i \alpha_j e^{-\frac{r_{ij}^2}{4\alpha_i \alpha_j}} \right)^{\frac{1}{2}} }.
 \end{aligned}
 \]</div>
<div class="exercise admonition" id="ex1">
<p class="admonition-title">Exercise 1</p>
<p>How may the solvent environment (especially in the case of a polar
solvent, such as dimethylformamide (DMF), and a polar
hydrogen-bonding solvent, such as water) influence the properties
(conformation, reactivity) of the solute? Which solvent do you
expect to be more difficult to mimick by an implicit model, DMF or
water?</p>
</div>
<div class="exercise admonition" id="ex2">
<p class="admonition-title">Exercise 2</p>
<p>In the context of the previous questions, explain possible advantages and pitfalls of using an implicit solvent compared to an explicit treatment.</p>
</div>
<div class="exercise admonition" id="ex3">
<p class="admonition-title">Exercise 3</p>
<p>A protein has the tendency to fold much quicker in implicit than in explicit solvent. Why is this? What are possible issues?</p>
</div>
</section>
</section>
</section>
<section id="properties-from-md">
<h2><span class="section-number">6.1.2. </span>Properties from MD<a class="headerlink" href="#properties-from-md" title="Permalink to this headline">#</a></h2>
<p>The great value of MD simulation techniques is rooted in the possibility
of easily deriving a certain set of properties from a complete
trajectory. Although the visual inspection of the changes that the
system undergoes as time evolves may be intuitively helpful, other tools
are needed to properly quantify the observed changes. Appropriate
measures may be based on simple concepts such as atomic displacements up
to more involved frameworks where the power spectra of the
time-evolution of the system are considered.</p>
<section id="rmsd">
<h3><span class="section-number">6.1.2.1. </span>RMSD<a class="headerlink" href="#rmsd" title="Permalink to this headline">#</a></h3>
<p>The root-mean-square deviation (RMSD) of atomic positions is an
important measure for studying conformational differences between
superimposed structures (<em>e.g.</em> proteins). Typically, structurally
relevant parts of a system are identified, superimposed and then aligned
such that the RMSD <a class="reference internal" href="#equation-rmsd">(6.9)</a> is minimised. This allows for a quantification of the
average displacement of the atoms between different systems, or between
different structures (snapshots) of the same system:</p>
<div class="math notranslate nohighlight" id="equation-rmsd">
<span class="eqno">(6.9)<a class="headerlink" href="#equation-rmsd" title="Permalink to this equation">#</a></span>\[
\begin{aligned}
\text{RMSD}^{a-b} = \sqrt{\frac{1}{N} \sum_{i=1}^N \left(\mathbf{r}_i^a-\mathbf{r}_i^b\right)^2},
\end{aligned}
\]</div>
<p>where <span class="math notranslate nohighlight">\(a, b\)</span> denote different structures, and the summation runs over
all <span class="math notranslate nohighlight">\(i\)</span> atoms of the same type up to the <span class="math notranslate nohighlight">\(N\)</span> atoms of interest. RMSD can
be especially useful in comparing protein structures, <em>i.e.</em> between
native and partially folded conformations.</p>
</section>
<section id="pressure-and-the-virial-theorem">
<h3><span class="section-number">6.1.2.2. </span>Pressure and the virial theorem<a class="headerlink" href="#pressure-and-the-virial-theorem" title="Permalink to this headline">#</a></h3>
<p>Many chemically relevant processes take place in the isothermal-isobaric
ensemble (<span class="math notranslate nohighlight">\(NpT\)</span>). In <span class="math notranslate nohighlight">\(NpT\)</span>-simulations, the simulation cell size changes
during the course of the simulation in order to keep the pressure
constant. The pressure is in practice often calculated based on the
<em>virial theorem</em> of Clausius. The virial is defined as:</p>
<div class="math notranslate nohighlight" id="equation-virial-theorem">
<span class="eqno">(6.10)<a class="headerlink" href="#equation-virial-theorem" title="Permalink to this equation">#</a></span>\[
\begin{aligned}
W = \sum_i^N \mathbf{q}_i \frac{\partial \mathbf{p}_i}{\partial \mathbf{q}_i},
\end{aligned}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> have their obvious meanings and the
sum runs over all <span class="math notranslate nohighlight">\(i\)</span> out of a total of <span class="math notranslate nohighlight">\(N\)</span> atoms. According to the
virial theorem, this is equivalent to:</p>
<div class="math notranslate nohighlight" id="equation-virial-alt">
<span class="eqno">(6.11)<a class="headerlink" href="#equation-virial-alt" title="Permalink to this equation">#</a></span>\[
\begin{aligned}
W = -3Nk_BT.
\end{aligned}
\]</div>
<p>The total virial of a system consists of an
ideal gas part (<span class="math notranslate nohighlight">\(-3PV\)</span>) and a contribution due to the interaction
between the particles:</p>
<div class="math notranslate nohighlight" id="equation-virial">
<span class="eqno">(6.12)<a class="headerlink" href="#equation-virial" title="Permalink to this equation">#</a></span>\[
\begin{aligned}
W = -3PV + \sum_{i=1}^N \sum_{j=N+1}^N r_{ij} \frac{\partial \upsilon(r_{ij})}{\partial r_{ij}},
\end{aligned}
\]</div>
<p>where <span class="math notranslate nohighlight">\(f_{ij} = \frac{\partial \upsilon(r_{ij})}{\partial r_{ij}}\)</span>
denotes the forces on the ions. The resulting expression for the
pressure is simply:</p>
<div class="math notranslate nohighlight" id="equation-pressure">
<span class="eqno">(6.13)<a class="headerlink" href="#equation-pressure" title="Permalink to this equation">#</a></span>\[
\begin{aligned}
P = \frac{1}{V} \left[Nk_BT - \frac{1}{3k_BT}\sum_{i=1}^N \sum_{j=i+1}^N r_{ij} f_{ij} \right].
\end{aligned}
\]</div>
<div class="exercise admonition" id="bex2">
<p class="admonition-title">Bonus Exercise 2</p>
<p>How expensive is the computation of the pressure in
<a class="reference internal" href="#equation-pressure">(6.13)</a>, via the virial, in an MD and an MC
algorithm, respectively?</p>
</div>
<div class="exercise admonition" id="bex3">
<p class="admonition-title">Bonus Exercise 3</p>
<p>Derive the ideal gas part of the virial in <a class="reference internal" href="#equation-virial">(6.12)</a>.</p>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "iesm"
        },
        kernelOptions: {
            kernelName: "iesm",
            path: "./Ex6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'iesm'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="MDMC_ex6.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">6. </span>Properties from Molecular Dynamics</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="proteinmodelling.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.2. </span>Protein Modelling</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Simon Duerr, Sophie Johnson, Irea Mosquera, Andrea Levy,  Ursula Roethlisberger<br/>
  
    <div class="extra_footer">
      <div class="container-lg mt-3 footer"> <div class="row"> <div class="col-xl-9 d-flex"> <div class="container"> <div class="row"> <div class="col-6 d-flex" style="justify-content:center"> <a href="https://lcbc.epfl.ch"> Laboratory of Computational Biochemistry and Chemistry</a></li>
</div> <div class="col-6 d-flex" style="justify-content:center"> <ul style="list-style:none"> <li> <a href="https://github.com/lcbc-epfl/mdmc-public">GitHub </a> </li> </li> <!--<li> <a href="https://doi.org/10.5281/zenodo.0000000"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.00000000.svg" alt="DOI"></a> </li>--> </ul> </div> </div> </div> </div> <div class="col-xl-3"> <a href="https://epfl.ch"><img src="https://www.epfl.ch/wp/5.5/wp-content/themes/wp-theme-2018/assets/svg/epfl-logo.svg?refresh=now" alt="EPFL Logo" style="padding:5px;height:33px;"></a> </div> </div> </div> <div class="row_footer my-3"> Dual licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Commons Attribution Share Alike 4.0 International</a> (CC BY SA 4.0) and MIT license. (Except where indicated otherwise) </div>
    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>