
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>6.1. Theory &#8212; Molecular Dynamics and Monte Carlo</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"TeX": {"Macros": {"ket": ["\\lvert #1 \\rangle", 1], "bra": ["\\langle #1 \\lvert", 1], "Ket": ["\\lvert #1 \\rangle", 1], "Bra": ["\\langle #1 \\lvert", 1], "braket": ["\\langle #1 \\lvert #2 \\rangle", 2], "hop": "\\hat{\\mathcal{H}}", "unit": "\\mathbbm{1}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Ex6/theory';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.2. Protein Modelling" href="proteinmodelling.html" />
    <link rel="prev" title="6. Properties from Molecular Dynamics" href="MDMC_ex6.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Molecular Dynamics and Monte Carlo</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Molecular Dynamics and Monte Carlo
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex1/MDMC_Ex1.html">1. Basic Concepts of Molecular Dynamics and Monte Carlo Simulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex1/Ex1_Theory.html">1.1. From Quantum to Classical Mechanics: The Example of Forces</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Ex1/MonteCarloPI.html">1.3. Monte Carlo <span class="math notranslate nohighlight">\(\pi\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex1/prng.html">1.4. Appendix: Random and Pseudo-random Numbers</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex2/MDMC_ex2.html">2. Statistical Thermodynamics and the Boltzmann Distribution</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex2/Ex2_Theory.html">2.1. Statistical Thermodynamics and the Boltzmann Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex2/Boltzmann.html">2.2. Boltzmann Distribution Harmonic Oscillator</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex3/MDMC_ex3.html">3. Monte Carlo Simulations and the Photon Gas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/Ex3_Theory.html">3.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/PhotonGas.html">3.2. The Photon Gas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex3/LJ_NVT.html">3.3. The Lennard-Jones Potential</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex4/MDMC_ex4.html">4. Introduction to Molecular Dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex4/Theory.html">4.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex4/Exercise.html">4.2. MD simulation from scratch</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Ex5/MDMC_ex5.html">5. Classical Molecular Dynamics (MD) Simulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/theory.html">5.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ex5/Exercise.html">5.2. ToyMD</a></li>

</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="MDMC_ex6.html">6. Properties from Molecular Dynamics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.1. Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="proteinmodelling.html">6.2. Protein Modelling</a></li>
<li class="toctree-l2"><a class="reference internal" href="TRP_Cage.html">6.3. Practical: TRP Cage using OpenMM</a></li>

</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://noto.epfl.ch/hub/user-redirect/git-pull?repo=https%3A//github.com/lcbc-epfl/mdmc-public&urlpath=lab/tree/mdmc-public/mdmc/Ex6/theory.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/lcbc-epfl/mdmc-public/blob/main/mdmc/Ex6/theory.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lcbc-epfl/mdmc-public" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lcbc-epfl/mdmc-public/issues/new?title=Issue%20on%20page%20%2FEx6/theory.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Ex6/theory.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Theory</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solvent-models-in-molecular-dynamics">6.1.1. Solvent Models in Molecular Dynamics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explicit-solvent">6.1.1.1. Explicit Solvent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implicit-solvent">6.1.1.2. Implicit Solvent</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sasa-solvent-accessible-surface-area-models">6.1.1.2.1. SASA: Solvent-accessible surface area models</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pb-poisson-boltzmann">6.1.1.2.2. PB: Poisson-Boltzmann</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gb-the-generalised-born-equation">6.1.1.2.3. GB: The Generalised Born equation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#properties-from-md">6.1.2. Properties from MD</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rmsd">6.1.2.1. RMSD</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pressure-and-the-virial-theorem">6.1.2.2. Pressure and the virial theorem</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="theory">
<span id="id1"></span><h1><span class="section-number">6.1. </span>Theory<a class="headerlink" href="#theory" title="Link to this heading">#</a></h1>
<section id="solvent-models-in-molecular-dynamics">
<h2><span class="section-number">6.1.1. </span>Solvent Models in Molecular Dynamics<a class="headerlink" href="#solvent-models-in-molecular-dynamics" title="Link to this heading">#</a></h2>
<p>The simulation of complex systems in their natural environment poses a
considerable challenge; the possibility of simulating a protein in a
cellular environment is not only constrained by the protein size itself,
but also by the large number of solvent molecules (water molecules,
ions) surrounding the biomolecular complex of interest. Since many of
the properties of any system in solution are governed by its
environment, the inclusion of solvation effects is a crucial ingredient
for any successful MD simulation (idem for MC).</p>
<section id="explicit-solvent">
<h3><span class="section-number">6.1.1.1. </span>Explicit Solvent<a class="headerlink" href="#explicit-solvent" title="Link to this heading">#</a></h3>
<p>The sheer number of water molecules surrounding a protein will
considerably increase the computational cost of a simulation, since the
simulation box has to be chosen reasonably big in order for the solvent
to properly mimic the properties of a bulk system and to prevent
interaction between the periodic images of the solute. Solvent molecules
have to be treated like the rest of the system (be it by a force field
or <em>first principles</em> methods), and are therefore referred to as an
<em>explicit solvent</em>.</p>
<p>The computational cost of using an explicit solvent can often be reduced
by choosing a suitable level of accuracy (<em>e.g.</em> in <em>ab initio</em> QM/MM
simulations, the chemically inert solvent molecules may be treated using
a force field). However, for larger systems that make exclusive use of
parametrised potentials, the number of molecules needed to solvate the
structure may easily overpass the number of atoms in the structure of
interest. This makes an explicit treatment prohibitively expensive due
to an exorbitantly high number of degrees of freedom that have to be
explicitly considered.</p>
<p>It is therefore often necessary to further simplify the description of
the system by using appropriate <em>implicit</em> solvent models instead of
explicit solvent.</p>
</section>
<section id="implicit-solvent">
<h3><span class="section-number">6.1.1.2. </span>Implicit Solvent<a class="headerlink" href="#implicit-solvent" title="Link to this heading">#</a></h3>
<p>Although an explicit description of solvent molecules is clearly
preferrable due to the natural inclusion of effects such as the
solvent’s response to polarisation, bridging and hydrogen-bonding, an
implicit mean-field contribution may already capture the most important
effects of the environment (such as changes in polarisability).
Formally, the solvent contribution to the Helmholtz (or Gibbs) free
energy (<span class="math notranslate nohighlight">\(F\)</span> and <span class="math notranslate nohighlight">\(G\)</span>, respectively) may be divided into different terms:</p>
<div class="math notranslate nohighlight" id="equation-free-energy-solvation">
<span class="eqno">(6.1)<a class="headerlink" href="#equation-free-energy-solvation" title="Link to this equation">#</a></span>\[
\begin{aligned}
\Delta F_\text{sol} = \Delta F_\text{cav} + \Delta F_\text{vdW} + \Delta F_\text{ele},
\end{aligned}
\]</div>
<p>where the energy is decomposed in components due to the formation of a
cavity in the solvent by the solute (<em>cav</em>) and the resulting van der
Waals (<em>vdW</em>) and electrostatic (<em>ele</em>) interactions. Different implicit
solvent models may account for different terms in eq. 1.
Solvent-accessible surface area models may take the entire
<span class="math notranslate nohighlight">\(\Delta F_\text{sol}\)</span> into account, the Poisson-Boltzmann and
Generalised-Born methods model solely <span class="math notranslate nohighlight">\(\Delta F_\text{ele}\)</span>.</p>
<section id="sasa-solvent-accessible-surface-area-models">
<h4><span class="section-number">6.1.1.2.1. </span>SASA: Solvent-accessible surface area models<a class="headerlink" href="#sasa-solvent-accessible-surface-area-models" title="Link to this heading">#</a></h4>
<p>SASA models assume the interactions between solute and solvent to be
proportional to the solute’s surface area. The free energy of solvation
is described by a mean solvent potential
<span class="math notranslate nohighlight">\(V_\text{solv}^\text{SASA}(\mathbf{r}_i)\)</span> that depends on the
atom-specific solvation energy per surface area <span class="math notranslate nohighlight">\(\sigma_i\)</span> and the
solvent-accessible surface area (SASA<span class="math notranslate nohighlight">\(_i\)</span>) for atom <span class="math notranslate nohighlight">\(i\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-sasa">
<span class="eqno">(6.2)<a class="headerlink" href="#equation-sasa" title="Link to this equation">#</a></span>\[
\begin{aligned}
V_\text{sol}^\text{SASA} = \sum_i \sigma_i \cdot \text{SASA}_i(\mathbf{r}_i).
\end{aligned}
\]</div>
<p>Various algorithms of different accuracy exist to calculate the SASA.</p>
</section>
<section id="pb-poisson-boltzmann">
<h4><span class="section-number">6.1.1.2.2. </span>PB: Poisson-Boltzmann<a class="headerlink" href="#pb-poisson-boltzmann" title="Link to this heading">#</a></h4>
<p>The Poisson equation relates the scalar electric potential
<span class="math notranslate nohighlight">\(\Phi(\mathbf{r})\)</span> to the charge density <span class="math notranslate nohighlight">\(\rho(\mathbf{r})\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eqpb1">
<span class="eqno">(6.3)<a class="headerlink" href="#equation-eqpb1" title="Link to this equation">#</a></span>\[
\begin{aligned}
\nabla \cdot \left[\epsilon(\mathbf{r})\nabla \Phi(\mathbf{r})  \right] = -\frac{\rho(\mathbf{r})}{\epsilon_0},
\end{aligned}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon(\mathbf{r})\)</span> is the local dielectric constant and
<span class="math notranslate nohighlight">\(\epsilon_0\)</span> the vacuum permitivity. The solution of Poisson’s equation
for the potential requires knowing the charge density distribution such
that</p>
<div class="math notranslate nohighlight" id="equation-charge-density-dist">
<span class="eqno">(6.4)<a class="headerlink" href="#equation-charge-density-dist" title="Link to this equation">#</a></span>\[
 \begin{aligned}
\Phi(\mathbf{r}) = \frac{1}{4\pi \epsilon_0 \epsilon(\mathbf{r})} \int \frac{\rho(\mathbf{r})}{\left|\mathbf{r}\right|} \mathrm{d}V(\mathbf{r}).
\end{aligned}
\]</div>
<p>In the case of an ionic solution (solvent), the electrostatic potential
resulting from a solvated charge density <span class="math notranslate nohighlight">\(\rho^{f}(\mathbf{r})\)</span> (solute)
should account for electrostatic forces between solute and solvent as
well as the ions thermal motion. Assuming ions as point charges, their
concentrations is expected to follow a Boltzmann distribution at thermal
equilibrium:</p>
<div class="math notranslate nohighlight" id="equation-conc">
<span class="eqno">(6.5)<a class="headerlink" href="#equation-conc" title="Link to this equation">#</a></span>\[
c_i(\mathbf{r}) = c_i^{\infty} \cdot \text{exp}\left(-\frac{U_i(\mathbf{r})}{k_B T}\right)
\]</div>
<p>where <span class="math notranslate nohighlight">\(c_i^{\infty}\)</span> represents the concentration of the ion <span class="math notranslate nohighlight">\(i\)</span> (of
electrostatic energy <span class="math notranslate nohighlight">\(U_i(\mathbf{r})\)</span>) at a distance of infinity from
the solute (bulk concentration). <span class="math notranslate nohighlight">\(k_B\)</span> is the Boltzmann constant and <span class="math notranslate nohighlight">\(T\)</span>
the temperature.</p>
<p>Considering <a class="reference internal" href="#equation-conc">(6.5)</a>
in <a class="reference internal" href="#equation-eqpb1">(6.3)</a>, one
obtains a special case of the Poisson equation, the <em>Poisson-Boltzmann</em>
(PB) equation. You will go through the derivation of the PB equation as
an exercise. The PB equation can further be linearized under the
assumption that the potential is small which yields:</p>
<div class="math notranslate nohighlight" id="equation-eqpb2">
<span class="eqno">(6.6)<a class="headerlink" href="#equation-eqpb2" title="Link to this equation">#</a></span>\[
\begin{aligned}
\nabla \cdot \left[\epsilon_0\epsilon(\mathbf{r})\nabla \Phi(\mathbf{r})  \right] + \rho_\text{ext}(\mathbf{r}) =  \left(\frac{q^2}{k_B T} \sum_i c_i^{\infty} z_i^2\right) \Phi(\mathbf{r})
\end{aligned}
\]</div>
<p>with <span class="math notranslate nohighlight">\(z_i\)</span> the valence of the ion, <span class="math notranslate nohighlight">\(q\)</span> is the charge of a proton and
<span class="math notranslate nohighlight">\(\rho_\text{ext}(\mathbf{r})\)</span> is an effective density from solute and
solvent.</p>
<div class="exercise admonition">
<p class="admonition-title">Exercise 1 - Bonus</p>
<p>Derive <a class="reference internal" href="#equation-eqpb2">(6.6)</a> from <a class="reference internal" href="#equation-eqpb1">(6.3)</a> by passing via the exponential form of the Poisson-Boltzmann equation <a class="reference internal" href="#equation-conc">(6.5)</a>.    Give an appropriate expression for the equilibrium charge density  <span class="math notranslate nohighlight">\(\rho_\text{ext}(\mathbf{r})\)</span> in the Poisson-Boltzmann approach.</p>
</div>
</section>
<section id="gb-the-generalised-born-equation">
<h4><span class="section-number">6.1.1.2.3. </span>GB: The Generalised Born equation<a class="headerlink" href="#gb-the-generalised-born-equation" title="Link to this heading">#</a></h4>
<p>Alternatively, the Poisson-Boltzmann equation may be solved for a charge
in the centre of an ideally spherical solute, yielding the Generalised
Born (GB) equation:</p>
<div class="math notranslate nohighlight" id="equation-gb">
<span class="eqno">(6.7)<a class="headerlink" href="#equation-gb" title="Link to this equation">#</a></span>\[
\begin{aligned}
\Delta F_\text{solv} = \frac{1}{2} \left( \frac{1}{\epsilon_\text{int}} -\frac{1}{\epsilon_\text{ext}} \right) \frac{q^2}{\alpha}.
\end{aligned}
\]</div>
<p>Here, <span class="math notranslate nohighlight">\(q\)</span> is the unit charge, the solute has radius <span class="math notranslate nohighlight">\(\alpha\)</span> and an
internal dielectric constant <span class="math notranslate nohighlight">\(\epsilon_\text{int}\)</span> and is embedded in a
solvent with a dielectric <span class="math notranslate nohighlight">\(\epsilon_\text{ext}\)</span>. The GB method emulates
a local pseudo-ideal solution within a non-ideal solute by varying
<span class="math notranslate nohighlight">\(\alpha\)</span>. This <em>effective Born radius</em> adjusts the local screening to
the best possible value with respect to some reference data. The
effective Born radii of all species are then used to compute GB pair
terms:</p>
<div class="math notranslate nohighlight" id="equation-gb-pair-terms">
<span class="eqno">(6.8)<a class="headerlink" href="#equation-gb-pair-terms" title="Link to this equation">#</a></span>\[
\begin{aligned}
\Delta F_\text{solv} = \frac{1}{2} \sum_{ij} \frac{\left( \frac{1}{\epsilon_\text{int}} -\frac{1}{\epsilon_\text{ext}} \right)
 q_i q_j}{\left(r_{ij}^2 +\alpha_i \alpha_j e^{-\frac{r_{ij}^2}{4\alpha_i \alpha_j}} \right)^{\frac{1}{2}} }.
 \end{aligned}
 \]</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 2</p>
<p>How may the solvent environment (especially in the case of a polar
solvent, such as dimethylformamide (DMF), and a polar
hydrogen-bonding solvent, such as water) influence the properties
(conformation, reactivity) of the solute? Which solvent do you
expect to be more difficult to mimic by an implicit model, DMF or
water?</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 3</p>
<p>In the context of the previous questions, explain possible advantages and pitfalls of using an implicit solvent compared to an explicit treatment.</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 4</p>
<p>A protein has the tendency to fold much quicker in implicit than in explicit solvent. Why is this? What are possible issues?</p>
</div>
</section>
</section>
</section>
<section id="properties-from-md">
<h2><span class="section-number">6.1.2. </span>Properties from MD<a class="headerlink" href="#properties-from-md" title="Link to this heading">#</a></h2>
<p>The great value of MD simulation techniques is rooted in the possibility
of easily deriving a certain set of properties from a complete
trajectory. Although the visual inspection of the changes that the
system undergoes as time evolves may be intuitively helpful, other tools
are needed to properly quantify the observed changes. Appropriate
measures may be based on simple concepts such as atomic displacements up
to more involved frameworks where the power spectra of the
time-evolution of the system are considered.</p>
<section id="rmsd">
<h3><span class="section-number">6.1.2.1. </span>RMSD<a class="headerlink" href="#rmsd" title="Link to this heading">#</a></h3>
<p>The root-mean-square deviation (RMSD) of atomic positions is an
important measure for studying conformational differences between
superimposed structures (<em>e.g.</em> proteins). Typically, structurally
relevant parts of a system are identified, superimposed and then aligned
such that the RMSD <a class="reference internal" href="#equation-rmsd">(6.9)</a> is minimised. This allows for a quantification of the
average displacement of the atoms between different systems, or between
different structures (snapshots) of the same system:</p>
<div class="math notranslate nohighlight" id="equation-rmsd">
<span class="eqno">(6.9)<a class="headerlink" href="#equation-rmsd" title="Link to this equation">#</a></span>\[
\begin{aligned}
\text{RMSD}^{a-b} = \sqrt{\frac{1}{N} \sum_{i=1}^N \left(\mathbf{r}_i^a-\mathbf{r}_i^b\right)^2},
\end{aligned}
\]</div>
<p>where <span class="math notranslate nohighlight">\(a, b\)</span> denote different structures, and the summation runs over
all <span class="math notranslate nohighlight">\(i\)</span> atoms of the same type up to the <span class="math notranslate nohighlight">\(N\)</span> atoms of interest. RMSD can
be especially useful in comparing protein structures, <em>i.e.</em> between
native and partially folded conformations.</p>
</section>
<section id="pressure-and-the-virial-theorem">
<h3><span class="section-number">6.1.2.2. </span>Pressure and the virial theorem<a class="headerlink" href="#pressure-and-the-virial-theorem" title="Link to this heading">#</a></h3>
<p>Many chemically relevant processes take place in the isothermal-isobaric
ensemble (<span class="math notranslate nohighlight">\(NpT\)</span>). In <span class="math notranslate nohighlight">\(NpT\)</span>-simulations, the simulation cell size changes
during the course of the simulation in order to keep the pressure
constant. The pressure is in practice often calculated based on the
<em>virial theorem</em> of Clausius. The virial is defined as:</p>
<div class="math notranslate nohighlight" id="equation-virial-theorem">
<span class="eqno">(6.10)<a class="headerlink" href="#equation-virial-theorem" title="Link to this equation">#</a></span>\[
\begin{aligned}
W = \sum_i^N \mathbf{q}_i \frac{\partial \mathbf{p}_i}{\partial \mathbf{q}_i},
\end{aligned}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> have their obvious meanings and the
sum runs over all <span class="math notranslate nohighlight">\(i\)</span> out of a total of <span class="math notranslate nohighlight">\(N\)</span> atoms. According to the
virial theorem, this is equivalent to:</p>
<div class="math notranslate nohighlight" id="equation-virial-alt">
<span class="eqno">(6.11)<a class="headerlink" href="#equation-virial-alt" title="Link to this equation">#</a></span>\[
\begin{aligned}
W = -3Nk_BT.
\end{aligned}
\]</div>
<p>The total virial of a system consists of an
ideal gas part (<span class="math notranslate nohighlight">\(-3PV\)</span>) and a contribution due to the interaction
between the particles:</p>
<div class="math notranslate nohighlight" id="equation-virial">
<span class="eqno">(6.12)<a class="headerlink" href="#equation-virial" title="Link to this equation">#</a></span>\[
\begin{aligned}
W = -3PV + \sum_{i=1}^N \sum_{j=N+1}^N r_{ij} \frac{\partial \upsilon(r_{ij})}{\partial r_{ij}},
\end{aligned}
\]</div>
<p>where <span class="math notranslate nohighlight">\(f_{ij} = \frac{\partial \upsilon(r_{ij})}{\partial r_{ij}}\)</span>
denotes the forces on the ions. The resulting expression for the
pressure is simply:</p>
<div class="math notranslate nohighlight" id="equation-pressure">
<span class="eqno">(6.13)<a class="headerlink" href="#equation-pressure" title="Link to this equation">#</a></span>\[
\begin{aligned}
P = \frac{1}{V} \left[Nk_BT - \frac{1}{3k_BT}\sum_{i=1}^N \sum_{j=i+1}^N r_{ij} f_{ij} \right].
\end{aligned}
\]</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 5 - Bonus</p>
<p>Is the computation of the pressure in
<a class="reference internal" href="#equation-pressure">(6.13)</a>, via the virial, more expensive in an MD and an MC
algorithm? And why?</p>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exercise 6 - Bonus</p>
<p>Derive the ideal gas part of the virial in <a class="reference internal" href="#equation-virial">(6.12)</a> using <a class="reference internal" href="#equation-virial-alt">(6.11)</a>.</p>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "compchem"
        },
        kernelOptions: {
            name: "compchem",
            path: "./Ex6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'compchem'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="MDMC_ex6.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Properties from Molecular Dynamics</p>
      </div>
    </a>
    <a class="right-next"
       href="proteinmodelling.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.2. </span>Protein Modelling</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solvent-models-in-molecular-dynamics">6.1.1. Solvent Models in Molecular Dynamics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explicit-solvent">6.1.1.1. Explicit Solvent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implicit-solvent">6.1.1.2. Implicit Solvent</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sasa-solvent-accessible-surface-area-models">6.1.1.2.1. SASA: Solvent-accessible surface area models</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pb-poisson-boltzmann">6.1.1.2.2. PB: Poisson-Boltzmann</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gb-the-generalised-born-equation">6.1.1.2.3. GB: The Generalised Born equation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#properties-from-md">6.1.2. Properties from MD</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rmsd">6.1.2.1. RMSD</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pressure-and-the-virial-theorem">6.1.2.2. Pressure and the virial theorem</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Laboratory of Computational Biochemistry and Chemistry - Ursula Roethlisberger
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>