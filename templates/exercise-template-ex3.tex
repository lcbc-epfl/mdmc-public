\documentclass{article}
\usepackage{xcolor}
\usepackage{mdframed}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{hyperref}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
\lstset{style=mystyle}
\title{Exercise Ex3}
\begin{document}
\maketitle\maketitle

Student:  Firstname Lastname    Sciper: 000000

\begin{mdframed}
\textbf{Please use this template to submit your answers.}\\
If you had to modify code from the notebook, please include the modified code in your submission either as screenshot or in a

\begin{verbatim}
\begin{lstlisting}[language=Python]
\end{lstlisting}
\end{verbatim}

environment.

You only need to include the code cells that you modified.

Note, that references to other parts of the documents aren't resolved in this template and will show as \texttt{??}. Check the text of the exercises on website for the reference
\end{mdframed}

\begin{mdframed}
\textbf{Exercise 1}\\
Show that if the Hamiltonian of a system can be written as: $H = T(\mathbf{p}) + V(\mathbf{q})$,
i.e. if the kinetic and potential energy can be decoupled, then the partition function can be divided into a kinetic and potential part. Derive (\ref{ensembleaverage}) for an ensemble average of an observable $O(\mathbf{q})$, which depends only on $\mathbf{q}$.
\end{mdframed}

Your answer here

\begin{mdframed}
\textbf{Exercise 2 - Bonus}\\
Why is it important that $P'$ is a symmetric matrix?
\end{mdframed}

Your answer here

\begin{mdframed}
\textbf{Exercise 3}\\
Make modifications in the code, right after the commented section \texttt{MODIFICATION ... END MODIFICATION}. Include the entire code within your report and comment upon the part that you wrote.
\end{mdframed}

Your answer here

\begin{mdframed}
\textbf{Exercise 4}\\
How can this scheme retain detailed balance when $n_j = 0$? Note that $n_j$  cannot be negative.
\end{mdframed}

Your answer here

\begin{mdframed}
\textbf{Exercise 5}\\
Using your code, plot the photon-distribution (average occupation number as a function of $\beta\epsilon\in[0.1,2]$).
Assume that the initial $n_j =1$ and $\epsilon_j=\epsilon$ and recalculate the with the same $\beta\epsilon$ values the analytical solution

\begin{equation}
\left< N \right> = \frac{1}{e^{\beta\epsilon}-1}
\end{equation}


Plot your calculated values versus those from the analytical solution and include your curve in your report. What is the influence of the number of MC iterations on the estimated result vs the analytical one? Why?
\end{mdframed}

Your answer here

\begin{mdframed}
\textbf{Exercise 6 - Bonus}\\
Modify the program in such a way that the averages are updated only after an accepted trial move. Why does ignoring rejected moves lead to erroneous results? \textit{Hint}: define $P'(o \rightarrow o)$ (\textit{i.e}  the probability that you stay in the old configuration) and recall that the transition probability $P'$ is normalised.
\end{mdframed}

Your answer here

\begin{mdframed}
\textbf{Exercise 7 - Bonus}\\
At which values of $\beta$ does the error you obtain when ignoring rejected moves become more pronounced? Why?
\end{mdframed}

Your answer here

\begin{mdframed}
\textbf{Exercise 8}\\
Perform a simulation at $T = 2.0$ and $\rho \in [0.05, 0.5, 2, 10.0]$. What do you observe?
\end{mdframed}

Your answer here

\begin{mdframed}
\textbf{Exercise 9}\\
The program produces a trajectory. Look at it and explain the behavior of the system over time for $\rho$ 0.85
\end{mdframed}

Your answer here

\begin{mdframed}
\textbf{Exercise 10}\\
Instead of performing a trial move in which only one particle is displaced, one can do a trial move in which more particles are
displaced simultaneously. You can find below a modified version of the code, where for each step \texttt{nParticlesMove} are displaced.
From the given code, explain how a trial move is now performed and what changes with respect to the previous case.

\textit{Hint}: It can be helpful to perform different tests, e.g. using \texttt{nParticlesMove = nPart} or, for example, \texttt{nParticlesMove = nPart/2}. Describe the changes you see in the energies and the trajectories in this new version of the code.
\end{mdframed}

Your answer here

\begin{mdframed}
\textbf{Exercise 11 - Bonus}\\
The code to sample the NPT ensemble is provided below. What needs to be changed in the code to sample from the isothermic-isobaric ensemble (NpT) instead of the microcanonical ensemble (NVT)?
\end{mdframed}

Your answer here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%  acronyms & glossary  %%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}
